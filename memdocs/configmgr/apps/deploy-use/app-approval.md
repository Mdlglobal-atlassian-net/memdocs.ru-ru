---
title: Утверждение приложений
titleSuffix: Configuration Manager
description: Дополнительные сведения о параметрах и поведении утверждения приложений в Configuration Manager.
ms.date: 05/04/2020
ms.prod: configuration-manager
ms.technology: configmgr-app
ms.topic: conceptual
ms.assetid: 20493c86-6454-4b35-8f22-0d049b68b8bb
author: aczechowski
ms.author: aaroncz
manager: dougeby
ms.openlocfilehash: f725c1b7dc380a84cd94e666b98dbd309df3744c
ms.sourcegitcommit: 14d7dd0a99ebd526c9274d5781c298c828323ebf
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/05/2020
ms.locfileid: "82802061"
---
# <a name="approve-applications-in-configuration-manager"></a>Утверждение приложений в Configuration Manager

*Область применения: Configuration Manager (Current Branch)*

При [развертывании приложения](deploy-applications.md) в Configuration Manager может потребоваться утверждение перед установкой. Пользователи запрашивают приложения в центре программного обеспечения, а вы просматриваете их запросы в консоли Configuration Manager. Можно утвердить или отклонить запрос.

## <a name="approval-settings"></a><a name="bkmk_approval"></a> Параметры утверждения

Поведение одобрения приложения зависит от того, включена ли рекомендуемая [дополнительная функция утверждения приложений](#bkmk_opt). Один из следующих вариантов утверждения отображается на странице **Параметры развертывания** для развертывания приложения:  

### <a name="an-administrator-must-approve-a-request-for-this-application-on-the-device"></a><a name="bkmk_opt"></a> Администратор должен утвердить запрос для этого приложения на устройстве

> [!Note]  
> По умолчанию в Configuration Manager эта функция отключена. Прежде чем использовать ее, включите необязательную функцию **Утверждение запросов приложений для пользователей на устройство**. Дополнительные сведения см. в разделе [Включение дополнительных функций из обновлений](../../core/servers/manage/install-in-console-updates.md#bkmk_options).
>
> Если этот параметр не включен, вы не сможете увидеть [описанное выше поведение](#bkmk_prior).  

Администратор должен утвердить все запросы пользователя для приложения, прежде чем пользователь может установить его на запрошенном устройстве. Если администратор одобряет запрос, пользователь может установить приложение только на этом устройстве. Пользователь должен отправить другой запрос, чтобы установить приложение на другом устройстве. Этот параметр недоступен при развертывании с целью **Обязательное** и в том случае, если приложение развертывается в коллекции устройств. <!--1357015-->  

> [!Note]  
> Чтобы воспользоваться преимуществами новых функций Configuration Manager, сначала необходимо обновить клиенты до последней версии. Хотя новые функции появляются в консоли Configuration Manager после обновления ее и сайта, полный сценарий будет работать только с последней версией клиента.<!--SCCMDocs issue 646-->  

В консоли Configuration Manager в рабочей области **Библиотека программного обеспечения** в разделе **Управление приложениями** просмотрите **Запросы приложений**. (В версии 1902 и более ранних этот узел называется **Запросы на утверждение**.) Теперь для каждого запроса в списке есть столбец **Устройство**. При выполнении действия по запросу диалоговое окно "Запрос приложения" также будет включать имя устройства, с которого пользователь отправил запрос.

Если запрос не утверждается в течение 30 дней, он удаляется. Переустановка клиента может привести к отмене всех ожидающих запросов утверждения.  

Если вам требуется утверждение для развертывания в коллекции устройств, приложение в центре программного обеспечения не отображается. Если вам требуется утверждение для развертывания в коллекции пользователей, приложение в центре программного обеспечения отображается. Его можно скрыть его от пользователей с помощью клиентского параметра **Скрыть неутвержденные приложения в центре программного обеспечения**. Дополнительные сведения см. в разделе о [параметрах клиентов в центре программного обеспечения](../../core/clients/deploy/about-client-settings.md#software-center).

Подтвердив установку приложения, вы можете впоследствии отклонить запрос, нажав кнопку **Отклонить** в консоли Configuration Manager. Если пользователь еще не установил приложение, это действие останавливает установку его новых копий из центра программного обеспечения. Если приложение было утверждено и установлено ранее, когда вы **отклоняете** для него запрос, клиент удаляет его с устройства пользователя.<!--1357891-->

Начиная с версии 1906, если вы утвердите запрос на приложение в консоли, а затем отклоните его, вы сможете утвердить его снова. Приложение повторно устанавливается на клиенте после его утверждения.  <!-- 4224910 -->

Вы можете автоматизировать процесс утверждения с помощью командлета PowerShell [Approve-CMApprovalRequest](https://docs.microsoft.com/powershell/module/configurationmanager/approve-cmapprovalrequest?view=sccm-ps). Начиная с версии 1902 этот командлет включает параметр **InstallActionBehavior**. Используйте этот параметр, чтобы указать, следует ли устанавливать приложение немедленно или во время нерабочего времени.<!-- SCCMDocs-pr issue #3418 -->

Начиная с версии 1906 вы можете видеть, какие развертывания требуют утверждения. Выберите приложение в узле **Приложения**. В области сведений перейдите на вкладку **Развертывания**. По умолчанию там отображается новый столбец — **Требуется утверждение**.

#### <a name="retry-the-install-of-pre-approved-applications"></a><a name="bkmk_retry"></a> Повтор попытки установки предварительно утвержденных приложений

<!--4336307-->
Начиная с версии 1906 вы можете повторить установку приложения, которое вы ранее утвердили для пользователя или устройства. Параметр утверждения — только для доступных развертываний. Если пользователь удаляет приложение или происходит сбой процесса первоначальной установки, Configuration Manager не требуется повторная оценка состояния и переустановка. Эта функция позволяет специалисту службы поддержки быстро повторить попытку установки приложения для пользователя, который обратился за помощью.

1. Откройте консоль Configuration Manager от имени пользователя, имеющего разрешение на **утверждение** объекта приложения. Например, встроенные роли **Администратор приложения** или **Автор приложения** имеют это разрешение.

1. Разверните приложение, которое требует утверждения, и утвердите его.

    > [!Tip]  
    > Либо выберите параметр [Установка приложения для устройства](install-app-for-device.md). Он создает запрос на утверждение для приложения на устройстве.  

Если приложение не устанавливается или пользователь удаляет приложение, выполните следующую процедуру, чтобы повторить попытку:

1. В консоли Configuration Manager перейдите в рабочую область **Библиотека программного обеспечения**, разверните узел **Управление приложениями** и выберите **Запросы приложений**. (В версии 1902 и более ранних этот узел называется **Запросы на утверждение**.)

1. Выберите ранее утвержденное приложение. В группе ленты "Запросы на утверждение" выберите **Повторить попытку установки**.

#### <a name="other-app-approval-resources"></a>Другие ресурсы по утверждению приложений

- [Усовершенствования утверждения приложений в ConfigMgr 1810](https://techcommunity.microsoft.com/t5/Configuration-Manager-Blog/Application-approval-improvements-in-ConfigMgr-1810/ba-p/303534)
- [Обновления в процессе утверждения приложений в Configuration Manager](https://techcommunity.microsoft.com/t5/Configuration-Manager-Blog/Updates-to-the-application-approval-process-in-Configuration/ba-p/275048)

### <a name="require-administrator-approval-if-users-request-this-application"></a><a name="bkmk_prior"></a> Запрос пользователем этого приложения должен утвердить администратор

> [!Note]  
> Это действие применяется, если не включить рекомендуемую [дополнительную функцию утверждения приложений](#bkmk_opt).

Администратор должен утвердить все запросы пользователя для приложения, прежде чем пользователь может установить его. Этот параметр недоступен при развертывании с целью **Обязательное** и в том случае, если приложение развертывается в коллекции устройств.  

Запросы на утверждение приложений отображаются в узле **Запросы приложений** в разделе **Управление приложениями** в рабочей области **Библиотека программного обеспечения**. (В версии 1902 и более ранних этот узел называется **Запросы на утверждение**.) Если запрос не утверждается в течение 30 дней, он удаляется. Переустановка клиента может привести к отмене всех ожидающих запросов утверждения.  

Подтвердив установку приложения, вы можете впоследствии отклонить запрос, нажав кнопку **Отклонить** в консоли Configuration Manager. Это действие не приводит к удалению приложения клиентом с устройств. Однако оно блокирует установку новых копий приложения пользователями из центра программного обеспечения.  

## <a name="email-notifications"></a><a name="bkmk_email-approve"></a> Уведомления по электронной почте

<!--1321550-->

Вы можете настроить отправку уведомлений по электронной почте о запросах на утверждение приложений. Когда пользователь запрашивает приложение, вы получаете по электронной почте уведомление. Щелкнув соответствующую ссылку в сообщении, вы можете утвердить или отклонить запрос без необходимости открывать консоль Configuration Manager.

Вы можете задать адреса электронной почты пользователей, которые могут утверждать или отклонять запросы при создании нового развертывания для приложения. Если вам нужно изменить список адресов электронной почты позже, перейдите на страницу **Мониторинг** рабочей области, разверните **Оповещения** и выберите узел **Подписки**. Выберите **Свойства** одной из подписок в разделе **Утвердить приложение по электронной почте**, связанных с вашим развертыванием приложения.

Если есть несколько оповещений, можно выяснить, какие предупреждения относятся к каждому развертыванию. Откройте свойства оповещения и просмотреть список **Выбранные оповещения** на вкладке "Общие". Развертывание включается в качестве оповещения для этой подписки.

Пользователи могут добавлять комментарии к запросу из центра программного обеспечения. Этот комментарий отображается в запросе приложения в консоли Configuration Manager. Начиная с версии 1902 этот комментарий также отображается в сообщении электронной почты. Отображение этого комментария в сообщении электронной почты помогает утверждающим утвердить или отклонить запрос.<!--3594063-->

### <a name="prerequisites"></a>Предварительные условия

#### <a name="to-send-email-notifications-and-take-action-on-internal-network"></a>Для отправки уведомлений по электронной почте и принятия мер во внутренней сети

С этими предварительными требованиями получатели получают сообщение электронной почты с уведомлением запроса. Если они находятся во внутренней сети, они также могут утверждать или отклонять запрос по электронной почте.

- Включите [необязательный параметр](../../core/servers/manage/install-in-console-updates.md#bkmk_options) **Утверждение запросов приложений для пользователей на устройство**.  

- Настройте [отправку оповещений по электронной почте](../../core/servers/manage/use-alerts-and-the-status-system.md#to-configure-email-notification-for-alerts).  

    > [!NOTE]
    > Развертывающему приложение пользователю с правами администратора требуется разрешение на создание предупреждения и подписки. Если у этого пользователя нет этих разрешений, в конце выполнения **мастера развертывания программного обеспечения** отобразится следующее сообщение об ошибке: "У вас нет прав доступа для выполнения этой операции".<!-- 2810283 -->

- Включите поставщик SMS на первичном сайте для использования сертификата.<!--SCCMDocs-pr issue 3135--> Используйте один из следующих методов.  

  - (Рекомендуется.) Включите [улучшенный протокол HTTP](../../core/plan-design/hierarchy/enhanced-http.md) для первичного сайта.

    > [!Note]  
    > Когда первичный сайт создает сертификат для поставщика SMS, веб-браузер на клиентском компьютере не доверяет ему. В зависимости от настроек безопасности при ответе на запрос приложения может отобразится предупреждение системы безопасности.  

  - Вручную привяжите PKI-сертификат к порту 443 в IIS на сервере, который поддерживает роль поставщика SMS на первичном сайте.

> [!NOTE]
> Если в иерархии имеется несколько дочерних первичных сайтов, настройте эти обязательные компоненты для каждого первичного сайта, на котором требуется включить данную функцию. Ссылки в уведомлении по электронной почте предназначены для службы администрирования на первичном сайте.<!-- 7108472 -->

#### <a name="to-take-action-from-internet"></a>Для принятия мер из Интернета

Эти дополнительные необязательные условия позволяют получателям утвердить или отклонить запрос из любого места, где они имеют доступ к Интернету.

- Включите службу администрирования поставщика SMS с помощью шлюза управления облачными клиентами. В консоли Configuration Manager перейдите в рабочую область **Администрирование**, разверните узел **Конфигурация сайта** и выберите узел **Серверы и роли системы сайта**. Выберите сервер с ролью поставщика SMS. В области сведений выберите роль **поставщика SMS**, а затем на ленте вкладки "Роль сайта" нажмите кнопку **Свойства**. Выберите пункт **Разрешить трафик шлюза управления облачными клиентами Configuration Manager для службы администрирования**.  

- Поставщику SMS требуется платформа **.NET 4.5.2** или более поздней версии.  

- Настройте [шлюз управления облачными клиентами](../../core/clients/manage/cmg/plan-cloud-management-gateway.md).

- Подключите сайт к [службам Azure](../../core/servers/deploy/configure/azure-services-wizard.md) для **управления облачными клиентами**.

- Включите [обнаружение пользователей Azure AD](../../core/servers/deploy/configure/configure-discovery-methods.md#azureaadisc).

- Вручную настройте параметры в Azure AD.  

    1. Войдите на [портал Azure](https://portal.azure.com) в качестве пользователя с правами *глобального администратора*. Перейдите в раздел **Azure Active Directory** и выберите **Регистрация приложений**.  

    1. Выберите приложение, созданное для интеграции **управления облачными клиентами** Configuration Manager.  

    1. В меню **Управление** выберите пункт **Проверка подлинности**.  

        1. В разделе **URI перенаправления** вставьте следующий тип: `https://<CMG FQDN>/CCM_Proxy_ServerAuth/ImplicitAuth`  

        1. Используйте вместо `<CMG FQDN>` полное доменное имя (FQDN) службы шлюза управления облачными клиентами (CMG). Например, GraniteFalls.Contoso.com.  

        1. Нажмите кнопку **Сохранить**.  

    1. В меню **Управление** выберите пункт **Манифест**.  

        1. В области редактирования манифеста найдите свойство **oauth2AllowImplicitFlow**.  

        1. Измените его значение на **true**. Так, вся строка должна выглядеть следующим образом: `"oauth2AllowImplicitFlow": true,`  

        1. Нажмите кнопку **Сохранить**.  

### <a name="configure-email-approval"></a>Настройка утверждения по электронной почте

1. В консоли Configuration Manager [разверните приложение](deploy-applications.md) как доступное для коллекции пользователей. На странице **Параметры развертывания** активируйте возможность его утверждения. Затем введите адреса электронной почты для получения уведомлений. Разделяйте адреса электронной почты точками с запятой (`;`).  

     > [!Note]  
     > Любой пользователь в организации Azure AD, который получит сообщение электронной почты, сможет утвердить запрос. Не пересылайте это сообщение другим пользователям, если в их обязанности не входит утверждение или отклонение запросов.  

2. В качестве пользователя запросите приложение в центре программного обеспечения.  

3. Вы получите уведомление по электронной почте в течение пяти минут. Содержимое сообщения электронной почты выглядит аналогично примеру:  

![Пример отправленного по электронной почте уведомления для утверждения приложения](media/1321550-email.png)

> [!Note]  
> Ссылка для утверждения или отклонения работает только один раз. Например, вы настроили псевдоним группы для получения уведомлений. Если Татьяна утвердит запрос, то Алексей уже не может его отклонить.  

Просмотрите файл **NotiCtrl.log** на сервере сайта для устранения неполадок.

## <a name="maintenance"></a>Обслуживание

Информация о запросах утверждения приложений сохраняется в базе данных сайта Configuration Manager. Для отмененных или отклоненных запросов сайт удаляет журнал запросов через 30 дней. Параметры удаления можно настроить с помощью [задачи обслуживания сайта](../../core/servers/manage/maintenance-tasks.md) **Удаление устаревших данных запросов приложений**. Сайт никогда не удаляет утвержденные или ожидающие запросы приложений.
