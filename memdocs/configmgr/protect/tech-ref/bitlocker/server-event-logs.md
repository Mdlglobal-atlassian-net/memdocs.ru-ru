---
title: Журналы событий сервера
titleSuffix: Configuration Manager
description: Технический справочник по возможным записям сервера BitLocker (MBAM) в журнале событий Windows
ms.date: 11/29/2019
ms.prod: configuration-manager
ms.technology: configmgr-protect
ms.topic: conceptual
ms.assetid: c3279b7d-654d-444b-bd17-1262894590c3
author: aczechowski
ms.author: aaroncz
manager: dougeby
ms.openlocfilehash: 8d49a24b6fea08f12d1fe70c1e0b7415adf98719
ms.sourcegitcommit: 1442a4717ca362d38101785851cd45b2687b64e5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2020
ms.locfileid: "82074815"
---
# <a name="server-event-logs"></a>Журналы событий сервера

*Область применения: Configuration Manager (Current Branch)*

<!--3601034-->

Используйте средство просмотра событий Windows с целью просмотра журналов событий для следующих компонентов сервера управления BitLocker в Configuration Manager:

- служба восстановления в точке управления;
- Портал самообслуживания
- Веб-сайт администрирования и мониторинга

На сервере, на котором размещается один или несколько из этих компонентов, откройте средство просмотра событий. Затем перейдите к узлу **Журналы приложений и служб** > **Майкрософт** > **Windows** и разверните узел **MBAM-Web**. По умолчанию существуют журналы событий [Администратор](#admin) и [Операционное](#operational).

В следующих разделах приводятся сообщения и сведения об устранении неполадок, связанные с идентификаторами событий, которые могут возникать в компонентах сервера управления BitLocker.

## <a name="admin"></a>Администратор

### <a name="1-webappspnerror"></a>1: WebAppSpnError

Приложение: в {SiteName}{VirtualDirectory} отсутствуют следующие имена субъектов-служб: {ListOfSpns}. Зарегистрируйте требуемые имена субъектов-служб в учетной записи: {ExecutionAccount}.

Чтобы встроенная проверка подлинности Windows выполнялась успешно, должны быть указаны обязательные имена субъектов-служб. Это сообщение означает, что имя участника-службы, требуемое для приложения, не настроено правильно. Узнать больше можно в подробных сведениях о событии.

<!-- See "Service Principal Name (SPN)" in MBAM 2.5 Server Prerequisites for Stand-alone and Configuration Manager Integration Topologies for more information. -->

### <a name="100-adminservicerecoverydberror"></a>100: AdminServiceRecoveryDbError

Возможные сообщения об ошибках:

- GetMachineUsers. Произошла ошибка при получении сведений о пользователях из базы данных.
- GetRecoveryKey. Произошла ошибка при получении ключа восстановления из базы данных.
- GetRecoveryKey. Произошла ошибка при получении сведений о пользователях из базы данных.
- GetRecoveryKeyIds. Произошла ошибка при получении идентификаторов ключей восстановления из базы данных.
- GetTpmHashForUser. Произошла ошибка при получении данных хэша доверенного платформенного модуля из базы данных восстановления.
- GetTpmHashForUser. Произошла ошибка при получении данных хэша доверенного платформенного модуля из базы данных восстановления.
- QueryDriveRecoveryData. Произошла ошибка при получении данных для восстановления диска из базы данных.
- QueryRecoveryKeyIdsForUser. Произошла ошибка при получении идентификаторов ключей восстановления из базы данных.
- QueryVolumeUsers. Произошла ошибка при получении сведений о пользователях из базы данных.

Это сообщение записывается каждый раз при возникновении исключения в процессе взаимодействии с базой данных восстановления. Чтобы получить подробные сведения об исключении, прочитайте трассировку.

### <a name="101-adminservicecompliancedberror"></a>101: AdminServiceComplianceDbError

Возможные сообщения об ошибках:

- GetRecoveryKey. Произошла ошибка при записи события аудита в базу данных соответствия.
- GetRecoveryKeyIds. Произошла ошибка при записи события аудита в базу данных соответствия.
- GetTpmHashForUser. Произошла ошибка при записи события аудита в базу данных соответствия.
- QueryRecoveryKeyIdsForUser. Произошла ошибка при записи события аудита в базу данных соответствия.
- QueryDriveRecoveryData. Произошла ошибка при записи события аудита в базу данных соответствия.

Это сообщение записывается каждый раз при возникновении исключения в процессе взаимодействии с базой данных соответствия. Чтобы получить подробные сведения об исключении, прочитайте трассировку.

### <a name="102-agentservicerecoverydberror"></a>102: AgentServiceRecoveryDbError

Это сообщение указывает на исключение, возникшее, когда служба пыталась связаться с базой данных восстановления. Чтобы получить подробные сведения об исключении, прочитайте сообщение события.

Убедитесь в том, что у учетной записи пула приложений MBAM есть необходимые разрешения для подключения к базе данных восстановления.

### <a name="103-agentserviceerror"></a>103: AgentServiceError

Возможные сообщения об ошибках:

- Не удалось обнаружить учетную запись клиентского компьютера или учетную запись пользователя для переноса данных.

    При каждом вызове веб-метода `PostKeyRecoveryInfo`, `IsRecoveryKeyResetRequired`, `CommitRecoveryKeyRest` или `GetTpmHash` он получает контекст вызывающего объекта для извлечения его учетных данных. Если контекст вызывающего объекта имеет значение NULL или пуст, служба записывает это сообщение.

- Не удалось проверить учетную запись для удостоверения вызывающего объекта.

    Это сообщение регистрируется, если веб-метод требует, чтобы вызывающим объектом была учетная запись компьютера, но это не так. Оно также может быть вызвано тем, что веб-метод требует, чтобы вызывающим объектом была учетная запись пользователя, но этот объект не является учетной записью пользователя или участником учетной записи группы переноса данных.

### <a name="104-statusservicecompliancedbconfigerror"></a>104: StatusServiceComplianceDbConfigError

Строка подключения к базе данных соответствия в реестре пуста.

Это сообщение записывается в журнал каждый раз, когда строка подключения к базе данных соответствия является недопустимой. Проверьте значение в разделе реестра `HKLM\Software\Microsoft\MBAM Server\Web\ComplianceDBConnectionString`.

### <a name="105-statusservicecompliancedberror"></a>105: StatusServiceComplianceDbError

Эта ошибка означает, что веб-сайтам или веб-службам не удалось подключиться к базе данных соответствия. Убедитесь в том, что учетная запись пула приложений IIS может подключиться к базе данных.

### <a name="106-helpdeskerror"></a>106: HelpdeskError

Известные ошибки и возможные причины:

- Запрос к URL-адресу привел к внутренней ошибке.

    В приложении для веб-сайта администрирования и мониторинга (службы поддержки) возникло необработанное исключение. Просмотрите записи журнала в журнале событий **Администратор**, чтобы найти конкретное исключение.

- Произошла ошибка при получении сведений о контексте выполнения. Не удалось проверить регистрацию имени субъекта-службы.

    При первоначальной загрузке веб-сайта службы поддержки он проверяет имя субъекта-службы. Для проверки имени субъекта-службы требуются сведения об учетной записи, имя сайта IIS и путь ApplicationVirtualPath, соответствующий веб-сайту службы поддержки. Это сообщение об ошибке регистрируется, если один или несколько из этих атрибутов являются недопустимыми или отсутствуют.

- Произошла ошибка при проверке регистрации имени субъекта-службы.

    Это сообщение означает, что при проверке имени субъекта-службы возникло исключение системы безопасности. См. исключение в подробных сведениях о событии.

### <a name="107-selfserviceportalerror"></a>107: SelfServicePortalError

Известные ошибки и возможные причины:

- Произошла ошибка при получении ключа восстановления для пользователя.

    Означает, что при выполнении запроса на получение ключа восстановления произошло непредвиденное исключение. См. сообщение об исключении в сведениях о событии. Если в приложении службы поддержки включена трассировка, подробные сообщения об исключениях можно найти в данных трассировки.

- Произошла ошибка при получении сведений о контексте выполнения. Не удалось проверить регистрацию имени субъекта-службы

    При первоначальной загрузке портал самообслуживания получает сведения об учетной записи, имя сайта IIS и путь ApplicationVirtualPath к веб-сайту самообслуживания для проверки имени субъекта-службы. Это сообщение об ошибке регистрируется, если один или несколько из этих атрибутов являются недопустимыми.

- Произошла ошибка при проверке регистрации имени субъекта-службы. EventDetails:{ExceptionMessage}

    Это сообщение означает, что при проверке имени субъекта-службы возникло исключение системы безопасности. См. исключение в подробных сведениях о событии.

### <a name="108-domaincontrollererror"></a>108: DomainControllerError

Известные ошибки и возможные причины:

- Произошла ошибка при разрешении доменного имени {DomainName}: сбой выделения памяти.

    Для разрешения доменного имени вызывается API Windows `DsGetDcName`. Это сообщение регистрируется, когда данный интерфейс API возвращает значение `ERROR_NOT_ENOUGH_MEMORY`, указывающее на ошибку выделения памяти.

- Не удалось вызвать метод DsGetDcName

    Это сообщение означает, что интерфейс API `DsGetDcName` недоступен на узле.

### <a name="109-webapprecoverydberror"></a>109: WebAppRecoveryDbError

Известные ошибки и возможные причины:

- Произошла ошибка при чтении конфигурации базы данных восстановления. Строка подключения к базе данных восстановления не настроена.

    Это сообщение означает, что сведения о строке подключения к базе данных восстановления в `HKLM\Software\Microsoft\MBAM Server\Web\RecoveryDBConnectionString` недопустимы. Проверьте указанное значение раздела реестра.

Если появляется одно из следующих сообщений, проверьте, могут ли учетные данные пула приложений с сервера IIS использоваться для установления соединения с базой данных восстановления:

- DoesUserHaveMatchingRecoveryKey. Произошла ошибка при получении идентификаторов ключей восстановления для пользователя.
- QueryDriveRecoveryData. Произошла ошибка при получении данных для восстановления диска.
- QueryRecoveryKeyIdsForUser. Произошла ошибка при получении идентификаторов ключей восстановления для пользователя.
- Произошла ошибка при получении хэша пароля доверенного платформенного модуля из базы данных восстановления.

### <a name="110-webappcompliancedberror"></a>110: WebAppComplianceDbError

Известные ошибки и возможные причины:

- Произошла ошибка при чтении конфигурации базы данных соответствия. Строка подключения к базе данных соответствия не настроена.

    Это сообщение означает, что сведения о строке подключения к базе данных соответствия в `HKLM\Software\Microsoft\MBAM Server\Web\ComplianceDBConnectionString` недопустимы. Проверьте значение этого раздела реестра.

Если появляется одно из следующих сообщений, проверьте, могут ли учетные данные пула приложений с сервера IIS использоваться для установления соединения с базой данных соответствия:

- GetRecoveryKeyForCurrentUser. Произошла ошибка при записи события аудита в базу данных соответствия.
- QueryRecoveryKeyIdsForUser. Произошла ошибка при записи события аудита в базу данных соответствия.
- QueryRecoveryKeyIdsForUser. Произошла ошибка при записи события аудита в базу данных соответствия.

### <a name="111-webappdberror"></a>111: WebAppDbError

Эти ошибки указывают на одну из двух ситуаций.

- Веб-сайтам или веб-службам MBAM не удалось подключиться к базе данных соответствия или восстановления.
- Учетной записи выполнения веб-сайтов или веб-служб MBAM (учетной записи пула приложений) не удалось выполнить хранимую процедуру `GetVersion` для базы данных соответствия или восстановления.

Дополнительные сведения об исключении приводятся в сообщении о событии.

Убедитесь в том, что учетная запись пула приложений может подключиться к базе данных соответствия или восстановления. Убедитесь в том, что у нее есть разрешения на выполнение хранимой процедуры `GetVersion`.

### <a name="112-webapperror"></a>112: WebAppError

Произошла ошибка при проверке регистрации имени субъекта-службы.

Для проверки имени субъекта-службы служба Active Directory должна получить список имен субъектов-служб, сопоставленных с учетной записью выполнения. Кроме того, из `ApplicationHost.config` запрашиваются привязки веб-сайтов. Это сообщение об ошибке означает, что не удалось связаться с Active Directory или загрузить файл `ApplicationHost.config`.

Убедитесь в том, что у учетной записи пула приложений есть разрешения на запрос Active Directory или файла `ApplicationHost.config`. Также проверьте записи привязки сайтов в файле `ApplicationHost.config`.

## <a name="operational"></a>Оперативный

### <a name="4-performancecountererror"></a>4\. PerformanceCounterError

Произошла ошибка при получении счетчика производительности.

Сообщение трассировки содержит фактическое сообщение об исключении. Некоторые из таких сообщений перечислены ниже.

- ArgumentNullException. Это исключение возникает, если категория, счетчик или экземпляр запрошенного счетчика производительности являются недопустимыми.
- System.InvalidOperationException. categoryName является пустой строкой (""). counterName является пустой строкой ("").
- Запрошенное разрешение на чтение или запись недопустимо для этого счетчика.
- Указанная категория не существует (если readOnly имеет значение true).
- Указанная категория не является пользовательской категорией .NET Framework (если readOnly имеет значение false).
- Указанная категория помечена как многоэкземплярная и требует создания счетчика производительности с именем экземпляра.
- Длина instanceName превышает 127 символов.
- categoryName и counterName локализованы на разные языки.
- System.ComponentModel.Win32Exception. Произошла ошибка при доступе к системному интерфейсу API.
- System.UnauthorizedAccessException: Код, выполняемый без прав администратора, попытался прочитать счетчик производительности.

Дополнительные сведения об исключении приводятся в сообщении о событии.

Для `System.UnauthorizedAccessException` убедитесь в том, что у учетной записи пула приложений есть доступ к интерфейсам API счетчика производительности.

### <a name="200-helpdeskinformation"></a>200: HelpDeskInformation

Приложение веб-сайта администрирования успешно нашло поддерживаемую версию базы данных восстановления или соответствия и подключилось к ней.

Означает успешное подключение к базе данных восстановления или соответствия с веб-сайта службы поддержки.

### <a name="201-selfserviceportalinformation"></a>201: SelfServicePortalInformation

Приложение портала самообслуживания успешно нашло поддерживаемую версию базы данных восстановления или соответствия и подключилось к ней.

Означает успешное подключение к базе данных восстановления или соответствия с портала самообслуживания.

### <a name="202-webappinformation"></a>202: WebAppInformation

Имена субъектов-служб приложения зарегистрированы правильно.

Означает, что имена субъектов-служб, необходимые для веб-сайта службы поддержки, правильно зарегистрированы в учетной записи выполнения.

## <a name="see-also"></a>См. также

Дополнительные сведения об использовании этих журналов см. в статье [Журналы событий BitLocker](about-event-logs.md).

Дополнительные сведения об устранении неполадок см. в разделе [Устранение неполадок BitLocker](troubleshoot.md).

Дополнительные сведения об установке этих веб-сайтов см. в статье [Настройка отчетов и порталов BitLocker](../../deploy-use/bitlocker/setup-websites.md).
