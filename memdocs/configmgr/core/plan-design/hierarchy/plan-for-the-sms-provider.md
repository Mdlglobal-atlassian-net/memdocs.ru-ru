---
title: Планирование использования поставщика SMS
titleSuffix: Configuration Manager
description: Сведения о роли системы сайта поставщика SMS в Configuration Manager.
ms.date: 04/01/2020
ms.prod: configuration-manager
ms.technology: configmgr-core
ms.topic: conceptual
ms.assetid: 5d5d6273-0d8a-43c7-865a-cdb1736dcae3
author: aczechowski
ms.author: aaroncz
manager: dougeby
ms.openlocfilehash: b01ea9b089da3cfcfc3e8d23e7ad25d27ab2fec7
ms.sourcegitcommit: bbf820c35414bf2cba356f30fe047c1a34c5384d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/21/2020
ms.locfileid: "81692762"
---
# <a name="plan-for-the-sms-provider"></a>Планирование использования поставщика SMS

*Область применения: Configuration Manager (Current Branch)*

Для управления Configuration Manager используется консоль Configuration Manager, которая подключается к экземпляру **поставщика SMS**. По умолчанию поставщик SMS устанавливается на сервере сайта при установке сайта центра администрирования или первичного сайта.

## <a name="about-the-sms-provider"></a><a name="BKMK_PlanSMSProv"></a> Сведения о поставщике SMS  

Поставщик SMS — это поставщик инструментария управления Windows (WMI), назначающий доступ на **чтение** и **запись** к базе данных Configuration Manager на сайте.  

- На каждом сайте центра администрирования и каждом первичном сайте должен присутствовать хотя бы один поставщик SMS. При необходимости можно установить дополнительные поставщики.  

- Группа безопасности **Администраторы SMS** предоставляет доступ к поставщику SMS. Configuration Manager автоматически создает эту группу на сервере сайта и на каждом компьютере, где устанавливается экземпляр поставщика SMS. Дополнительные сведения см. в разделе [Администраторы SMS](accounts.md#sms-admins).  

- На вторичных сайтах роль поставщика SMS не поддерживается.  

Пользователи Configuration Manager с правами администратора используют поставщик SMS для доступа к информации, хранящейся в базе данных. Для этого администраторы могут использовать консоль Configuration Manager, обозреватель ресурсов, средства и пользовательские скрипты. Поставщик SMS не взаимодействует с клиентами Configuration Manager. Когда консоль Configuration Manager подключается к сайту, она запрашивает WMI на сервере сайта, чтобы найти экземпляр поставщика SMS.  

Поставщик SMS помогает обеспечивать безопасность Configuration Manager. Он возвращает лишь ту информацию, которую разрешено просматривать пользователю, запустившему консоль.  

Поставщик SMS также предоставляет доступ API для взаимодействия по HTTPS. Это решение называется **службой администрирования**. Этот REST API можно использовать вместо пользовательской веб-службы для доступа к информации на сайте. Дополнительные сведения см. в разделе [Что такое служба администрирования?](../../../develop/adminservice/overview.md)

> [!IMPORTANT]  
> Если все экземпляры поставщика SMS для сайта отключены от сети, консоли Configuration Manager не смогут подключиться к базе данных сайта.  

Дополнительные сведения об управлении поставщиком SMS см. в статье [Управление поставщиком SMS](../../servers/manage/modify-your-infrastructure.md#BKMK_ManageSMSprovider).  

## <a name="installation-prerequisites"></a>Предварительные условия (и необходимые компоненты) для установки  

Для поддержки поставщика SMS на целевом сервере необходимо выполнить следующие условия:  

- Целевой сервер должен быть в одном домене с сервером сайта и системами сайта баз данных сайта.  

- На компьютере не может быть роли системы сайта другого сайта.  

- На компьютере не может быть поставщика SMS любого сайта.  

- На компьютере должна использоваться поддерживаемая версия ОС.  

- По крайней мере 650 МБ свободного места на диске для поддержки компонентов Windows ADK. Дополнительные сведения о Windows ADK и поставщике SMS см. в разделе [Требования для развертывания ОС](#BKMK_WAIKforSMSProv).  

- Для [REST API](../../../develop/adminservice/overview.md) службы администрирования:

  - .NET 4.5 или более поздней версии

  - Включить роль сервера Windows **Веб-сервер (IIS)**

    > [!Note]  
    > Каждый поставщик SMS пытается установить службу администрирования, а для этого нужен сертификат. Эта служба имеет зависимость от IIS, чтобы привязать сертификат к HTTPS-порту 443. При включении [усиленного HTTP](enhanced-http.md) сайт привязывает этот сертификат с помощью API-интерфейсов IIS. Если сайт использует PKI, необходимо вручную привязать PKI-сертификат в службах IIS поставщика SMS. Начиная с версии 2002, сайт автоматически использует самозаверяющий сертификат сайта.

## <a name="locations"></a><a name="bkmk_location"></a> Местоположения  

При установке сайта автоматически устанавливается первый поставщик SMS для сайта. Для поставщика SMS можно указать любое из следующих поддерживаемых расположений.  

- сервер сайта;  

- Сервер базы данных сайта  

- Другой сервер, который соответствует [предварительным требованиям для установки](#installation-prerequisites)  

Для просмотра расположений каждого поставщика SMS для сайта:

1. В консоли Configuration Manager перейдите в рабочую область **Администрирование**, разверните узел **Конфигурация сайта** и выберите узел **Сайты**.  

2. Выберите нужный сайт из списка, а затем **Свойства** на ленте.  

3. На вкладке **Общие** в разделе **Свойства** просмотрите поле **Расположение поставщика SMS**.  

Каждый поставщик SMS поддерживает одновременные подключения нескольких запросов. Для этих подключений ограничивается только число доступных серверных подключений в Windows и объем доступных ресурсов на сервере, использующихся для обслуживания запросов на подключение.  

После установки сайта вы можете снова запустить программу установки Configuration Manager на сервере сайта. Используйте ее, чтобы изменить расположение существующего поставщика SMS или установить на этом сайте дополнительные поставщики SMS. Устанавливайте только один поставщик SMS на компьютере. На компьютере не могут размещаться поставщики SMS с более чем одного сайта.  

### <a name="choosing-a-location"></a>Выбор места

Используйте следующие разделы, чтобы определить преимущества и недостатки установки поставщика SMS в каждом из поддерживаемых расположений.  

#### <a name="configuration-manager-site-server"></a>Сервер сайта Configuration Manager

- **Преимущества:**  

  - Поставщик SMS не использует системные ресурсы компьютера базы данных сайта.  

  - В этом расположении обеспечивается более высокая производительность по сравнению с установкой поставщика SMS на компьютере, отличном от сервера сайта или компьютера базы данных сайта.  

- **Недостатки:**  

  - Поставщик SMS использует системные и сетевые ресурсы, которые могут быть предоставлены для работы сервера сайта.  

#### <a name="sql-server-that-hosts-the-site-database"></a>SQL Server, на котором размещена база данных сайта

- **Преимущества:**  

  - Поставщик SMS не использует системные ресурсы сервера сайта.  

  - Это расположение может обеспечить наивысшую производительность из всех трех расположений при наличии достаточных серверных ресурсов.  

- **Недостатки:**  

  - Поставщик SMS использует системные и сетевые ресурсы, которые могут быть предоставлены для работы базы данных сайта.  

  - Это расположение нельзя использовать, если база данных сайта размещена в кластерном экземпляре SQL Server.  

#### <a name="computer-other-than-the-site-server-or-site-database-server"></a>Компьютер, отличный от сервера сайта и сервера базы данных сайта

- **Преимущества:**  

  - Поставщик SMS не использует системные ресурсы сервера сайта и базы данных сайта.  

  - Этот тип расположения дает возможность развертывать дополнительные поставщики SMS для обеспечения высокой доступности подключений.  

- **Недостатки:**  

  - Может быть снижена производительность поставщика SMS. Она может быть снижена из-за дополнительной сетевой активности, необходимой для координации с сервером сайта и компьютером базы данных сайта.  

  - Этот сервер должен быть всегда доступен серверу базы данных сайта и всем компьютерам с установленной консолью Configuration Manager.  

  - Этот расположение может использовать системные ресурсы, которые в противном случае были бы представлены другим службам.  

## <a name="authentication"></a><a name="bkmk_auth"></a> Проверка подлинности

<!--1357013-->
С версии 1810 вы можете указать минимально необходимый уровень аутентификации для доступа администраторов к сайтам Configuration Manager. Эта функция позволяет настроить для администраторов требование входить в Windows с определенным уровнем. Он применяется ко всем компонентам, которые обращаются к поставщику SMS. Сюда относятся консоль Configuration Manager, методы пакета SDK и командлеты Windows PowerShell.

### <a name="configure-authentication"></a>Настроить проверку подлинности

Чтобы изменить этот параметр, сначала войдите в Windows с нужным уровнем проверки подлинности.

> [!Important]  
> Эта конфигурация применяется для всей иерархии. Прежде чем изменять его значение, убедитесь, что все администраторы Configuration Manager могут выполнить вход в Windows с нужным уровнем проверки подлинности.

Чтобы настроить этот параметр, выполните следующие действия:

1. В консоли Configuration Manager перейдите в рабочую область **Администрирование**, разверните узел **Конфигурация сайта** и выберите узел **Сайты**.  

2. Выберите **Параметры иерархии** на ленте.  

3. Переключитесь на вкладку **Проверка подлинности**. Выберите нужный [уровень проверки подлинности](#authentication-levels), а затем нажмите **ОК**.  

    - Только при необходимости нажмите **Добавить** для исключения определенных пользователей или групп. Дополнительные сведения: [Исключения](#exclusions).  

### <a name="authentication-levels"></a>Уровни проверки подлинности

Доступны следующие уровни:

- **Аутентификация Windows**. Требуется аутентификация с доменными учетными данными Active Directory. Этот вариант соответствует прежнему поведению и используется как значение по умолчанию. При обновлении сайта уровень проверки подлинности не изменяется.  

- **Аутентификация на основе сертификата**. Требуется аутентификация с действительным сертификатом, выданным доверенным центром сертификации PKI. Этот сертификат не нужно настраивать в Configuration Manager. Configuration Manager требует, чтобы администратор входил в Windows с использованием PKI.  

- **Аутентификация Windows Hello для бизнеса**. Требуется строгая двухфакторная аутентификация с привязкой к устройству и использованием биометрических данных или ПИН-кода. Дополнительные сведения см. в разделе [Windows Hello для бизнеса](https://docs.microsoft.com/windows/security/identity-protection/hello-for-business/hello-identity-verification).  

### <a name="exclusions"></a>Исключения

На вкладке **Проверка подлинности** в настройках иерархии вы можете исключить определенных пользователей или группы. Используйте этот параметр только в случае необходимости. Это удобно,если определенному пользователю нужен доступ к консоли Configuration Manager, но он не может выполнять проверку подлинности Windows на требуемом уровне. Также это может потребоваться для автоматизации или служб, которые выполняются в контексте системной учетной записи.

## <a name="about-sms-provider-languages"></a><a name="BKMK_SMSProvLanguages"></a> Языки поставщика SMS  

Работа поставщика SMS не зависит от языка интерфейса, выбранного на сервере, на котором установлен поставщик SMS.  

Когда пользователь с правами администратора или Configuration Manager обрабатывает данные запросов с помощью поставщика SMS, тот пытается вернуть эти данные в формате, соответствующем языку интерфейса операционной системы компьютера, отправившего запрос.

Способ, которым он пытается установить соответствие языка, является в некоторой степени косвенным. Поставщик SMS не выполняет перевод данных с одного языка на другой. При возврате данных для отображения в консоли Configuration Manager язык отображения данных зависит от источника объекта и типа хранилища.  

Когда Configuration Manager сохраняет данные для объекта в базе данных, доступные языки зависят от следующих факторов:  

- При хранении в базе данных объектов, создаваемых Configuration Manager, поддерживается использование нескольких языков. Он сохраняет объект в базе данных сайта с указанием языков, настроенных для сайта при запуске программы установки. Эти объекты отображаются в консоли Configuration Manager с использованием языка, выбранного на запрашивающем данные компьютере, если этот язык доступен для объекта. Если объект не может быть отображен в консоли с использованием языка, выбранного на запрашивающем компьютере, он отображается с использованием языка по умолчанию (английский).  

- Объекты, создаваемые пользователями с правами администратора, хранятся в Configuration Manager с использованием языка, использованного для создания объекта. В консоли Configuration Manager эти объекты отображаются с использованием того же языка. Поставщик SMS не может перевести их, и у них нет поддержки нескольких языков.  

## <a name="use-multiple-sms-providers"></a><a name="BKMK_MultiSMSProv"></a> Использование нескольких поставщиков SMS  

После завершения установки сайта на нем можно установить дополнительные поставщики SMS. Для установки дополнительных поставщиков SMS запустите программу установки Configuration Manager на сервере сайта.

Установку дополнительных поставщиков SMS имеет смысл рассматривать при наличии любого из следующих условий.  

- Имеется много пользователей с правами администратора, запускающих консоль Configuration Manager и одновременно подключающихся к сайту.  

- Планируется использовать пакет SDK для Configuration Manager или другие продукты, которые могут часто использовать вызовы поставщика SMS.  

- У вас есть бизнес-требование для обеспечения высокой доступности поставщика SMS.  

Когда на сайте установлено несколько поставщиков SMS и поступает запрос, сайт случайным образом назначает каждому новому запросу на подключение один из установленных поставщиков SMS. Указать определенное расположение поставщика SMS для конкретного сеанса подключения невозможно.  

> [!NOTE]  
> Рассмотрите преимущества и недостатки каждого варианта расположения поставщиков SMS. Дополнительные сведения см. в разделе [Расположения](#bkmk_location). При этом учитывайте то, что контролировать выбор поставщика SMS для каждого нового подключения нельзя.  

При первом подключении консоли Configuration Manager к сайту подключение запрашивает WMI на сервере сайта. Этот запрос определяет экземпляр поставщика SMS, который использует консоль. Этот экземпляр поставщика SMS будет использоваться консолью до окончания сеанса. Если сеанс будет завершен, так как сервер поставщика SMS недоступен в сети, при восстановлении подключения консоли к сайту он повторяет начальный запрос. Вполне возможно, что сайт назначит тот экземпляр поставщика SMS, который недоступен. При этом следует повторять попытку подключения консоли, пока сеансу не будет назначен доступный поставщик SMS.  

## <a name="about-the-sms-provider-namespace"></a><a name="BKMK_SMSProvNamespace"></a> Пространство имен поставщика SMS  

Схема WMI Configuration Manager определяет структуру поставщика SMS. Расположение данных Configuration Manager в схеме поставщика SMS описывается пространством имен схемы. В следующей таблице приведены некоторые распространенные пространства имен, используемые поставщиком SMS.  

|Пространство имен|Описание:|  
|---------------|-----------------|  
|`Root\SMS\site_<site code>`|Поставщик SMS, активно используемый консолью Configuration Manager, обозревателем ресурсов, средствами Configuration Manager и сценариями.|  
|`Root\SMS\SMS_ProviderLocation`|Расположение компьютеров поставщиков SMS для сайта.|  
|`Root\CIMv2`|Расположение данных пространства имен WMI, полученное в ходе инвентаризации оборудования и программного обеспечения.|  
|`Root\CCM`|Политики конфигурации и данные клиента Configuration Manager.|  
|`Root\CIMv2\SMS`|Расположение классов отчетов об инвентаризации, собираемых агентом клиента инвентаризации. Клиенты компилируют эти параметры при оценке политики компьютера. Эти параметры основаны на конфигурации параметров клиента для компьютера.|  

## <a name="os-deployment-requirements"></a><a name="BKMK_WAIKforSMSProv"></a> Требования к развертыванию ОС

Компьютеру, где устанавливается экземпляр поставщика SMS, требуется поддерживаемая версия Windows ADK.  

Дополнительные сведения об этом требовании см. в разделе [Требования к инфраструктуре для развертывания операционной системы](../../../osd/plan-design/infrastructure-requirements-for-operating-system-deployment.md#windows-adk-for-windows-10) и [Поддержка Windows 10](../configs/support-for-windows-10.md).  

При управлении развертываниями операционных систем пакет Windows ADK позволяет поставщику SMS выполнять различные задачи, в том числе следующие:  

- просмотр информации о WIM-файле;  

- добавление драйверов в существующие загрузочные образы;  

- создание загрузочных ISO-файлов.  

Для пакета Windows ADK на каждом компьютере, где устанавливается поставщик SMS, может потребоваться до 650 МБ свободного места. Столь высокие требования к объему свободного места необходимы Configuration Manager для установки загрузочных образов среды предустановки Windows.  

## <a name="administration-service"></a><a name="bkmk_admin-service"></a> Служба администрирования

<!--3607711, fka 1321523-->

Поставщик SMS предоставляет доступ API для взаимодействия по HTTPS OData. Это решение называется **службой администрирования**. Этот REST API можно использовать вместо пользовательской веб-службы для доступа к информации на сайте.

Дополнительные сведения см. в разделе [Что такое служба администрирования?](../../../develop/adminservice/overview.md)
