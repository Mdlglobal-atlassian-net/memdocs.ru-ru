---
title: Удаление сайтов
titleSuffix: Configuration Manager
description: Руководство по удалению ролей, сайтов и иерархий
ms.date: 04/01/2020
ms.prod: configuration-manager
ms.technology: configmgr-core
ms.topic: conceptual
ms.assetid: d466edd2-97f0-44c1-a73e-d71abbdbf4a8
author: mestew
ms.author: mstewart
manager: dougeby
ms.openlocfilehash: a90d6f34370b8c3167272bce1a0a673cc5074094
ms.sourcegitcommit: bbf820c35414bf2cba356f30fe047c1a34c5384d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/21/2020
ms.locfileid: "81700532"
---
# <a name="uninstall-roles-sites-and-hierarchies-in-configuration-manager"></a>Удаление ролей, сайтов и иерархий в Configuration Manager

*Область применения: Configuration Manager (Current Branch)*

Эта статья поможет удалить роль системы сайта Configuration Manager, сайт или иерархию.

Начиная с версии 2002, можно также удалить сайт центра администрирования (CAS) из иерархии, сохранив первичный сайт.

## <a name="site-system-role"></a><a name="bkmk_role"></a> Роль системы сайта

Удаление роли с сервера системы сайта может потребоваться по следующим причинам.

- Обширное изменение инфраструктуры, например сетевого или физического расположения.
- Вывод базового сервера из эксплуатации.
- Консолидация ролей для снижения затрат и сложности
- Перенастройка или перепроектирование ролей сайта
- Отказ от функции, которую поддерживает эта роль

Если вы решили удалить роль, сначала ответьте на следующие вопросы.

- Требуется ли вам по-прежнему эта роль на сайте? Если да, то есть ли эта роль у другой системы сайта?

- Имеют ли другие системы сайта с этой ролью правильный размер для поддержки бизнес-требований по производительности и доступности?

- Все ли клиенты перенастроены для использования другой роли? Будете ли вы полагаться на поведение клиента по умолчанию, чтобы он мог вернуться или обнаружить другой сервер?

### <a name="procedure-to-remove-a-site-system-role"></a>Процедура удаления роли системы сайта

Чтобы удалить роль, выполните следующую процедуру.

1. В консоли **Configuration Manager** перейдите к рабочей области **Администрирование**. Разверните раздел **Конфигурация сайта**, а затем выберите узел **Серверы и роли системы сайта**.

1. Выберите сервер системы сайта с ролью, которую необходимо удалить. В области сведений **Роли системы сайта** выберите целевую роль.

1. На ленте на вкладке **Роль сайта** в группе **Роль сайта** щелкните **Удалить роль**. Подтвердите удаление роли.

### <a name="additional-information-for-specific-roles"></a>Дополнительные сведения об отдельных ролях

Некоторые роли могут потребовать выполнения дополнительных шагов и решения дополнительных вопросов.

#### <a name="software-update-point"></a>Точка обновления программного обеспечения

После удаления точки обновления программного обеспечения Configuration Manager обновляет политику клиента, чтобы удалить точку обновления программного обеспечения из списка. При удалении последней точки обновления программного обеспечения с сайта список точек обновления не будет содержать ничего. Если роли недоступны, управление обновлениями программного обеспечения по сути отключено на сайте.

Если вы используете более одной точки обновления программного обеспечения на первичном сайте и удаляете точку обновления программного обеспечения, настроенную в качестве источника синхронизации, вам следует выбрать другую точку обновления программного обеспечения на сайте в качестве нового источника.

## <a name="secondary-site"></a><a name="bkmk_secondary"></a> Вторичный сайт  

В отличие от [вывода иерархии из эксплуатации](#bkmk_hierarchy) основная причина удаления вторичного сайта — это обширное изменение инфраструктуры, например сетевого или физического расположения. Также ознакомьтесь с причинами, по которым стоит [выбрать вторичный сайт](../../../plan-design/hierarchy/design-a-hierarchy-of-sites.md#BKMK_ChooseSecondary).

Если вы решили удалить вторичный сайт, сначала ответьте на следующие вопросы.

- Вы удалили все роли системы сайта с сервера сайта?

- Есть ли границы или группы границ, связанные с дополнительным сайтом? Перенастройте границы перед удалением сайта.

- Есть ли клиенты, которые по-прежнему находятся в расположении?

- Вы настроили другие параметры управления содержимым, такие как [одноранговое кэширование](../../../plan-design/hierarchy/fundamental-concepts-for-content-management.md#peer-caching-technologies)?

### <a name="options-to-delete-secondary-sites"></a>Варианты удаления вторичных сайтов

Вторичный сайт невозможно переместить или переназначить другому первичному сайту. При удалении вторичного сайта со своего прямого родительского сайта выберите, как следует его удалить.

#### <a name="uninstall-the-secondary-site"></a>Отмена установки вторичного сайта

С помощью этого параметра можно удалить работающий вторичный сайт, доступный в сети. Этот параметр отменяет установку Configuration Manager на сервере вторичного сайта. Затем он удаляет все сведения о сайте и его ресурсах с сайта Configuration Manager.

Если Configuration Manager установил SQL Server Express для вторичного сайта, Configuration Manager также отменяет установку SQL Express. Если SQL Server Express был установлен до установки вторичного сайта, Configuration Manager не отменяет его установку.

#### <a name="delete-the-secondary-site"></a>Удаление вторичного сайта

Используйте этот вариант в следующих ситуациях.

- Его не удалось установить

- Вторичный сайт продолжает отображаться в консоли Configuration Manager после отмены установки

    Этот вариант удаляет всю информацию о сайте и его ресурсы из иерархии Configuration Manager, но не вносит изменений на сервере сайта.

    > [!TIP]
    >  Можно также использовать средство обслуживания иерархии и параметр **/DELSITE** для удаления вторичного сайта. Дополнительные сведения см. в разделе [Средство обслуживания иерархии (Preinst.exe)](../../manage/hierarchy-maintenance-tool-preinst.exe.md).

### <a name="prerequisites-to-delete-a-secondary-site"></a>Необходимые условия для удаления вторичного сайта

Убедитесь, что пользователь-администратор, запускающий программу установки Configuration Manager, имеет следующие права безопасности:

- права локального **администратора** на сервере вторичного сайта;

- если сервер базы данных первичного сайта находится на удалении от сервера первичного сайта — права локального **администратора** на удаленном сервере базы данных сайта для первичного сайта;

- роль **администратора инфраструктуры** или **полного администратора** на родительском первичном сайте.

- права **системного администратора** базы данных вторичного сайта.

### <a name="procedure-to-delete-a-secondary-site"></a>Процедура удаления вторичного сайта

Выполните следующую процедуру для удаления вторичного сайта.

1. В консоли Configuration Manager перейдите в рабочую область **Администрирование**, разверните узел **Конфигурация сайта** и выберите узел **Сайты**.

1. Выберите сервер вторичного сайта, который требуется удалить. На ленте на вкладке **Главная** в группе **Сайт** нажмите кнопку **Удалить**.

1. На странице **Общие** укажите, следует ли удалить вторичный сайт или отменить его установку.

1.  Завершите работу мастера.

## <a name="primary-site"></a><a name="bkmk_primary"></a> Первичный сайт  

Отмена установки первичного сайта в иерархии может потребоваться по следующим причинам.

- Консолидация сайтов для снижения затрат и сложности
- Перенастройка или перепроектирование сайтов иерархии

Перед удалением дочернего первичного сайта с [распределенными представлениями](../../../plan-design/hierarchy/database-replication.md#bkmk_distviews) в канале репликации с сайтом центра администрирования (CAS) сначала необходимо отключить в вашей иерархии распределенные представления. Дополнительные сведения см. в статье [Удаление первичного сайта с настроенными распределенными представлениями](#bkmk_distviews).

### <a name="plan-to-uninstall-a-primary-site"></a><a name="bkmk_pri-plan"></a> Планирование отмены установки первичного сайта

Перед отменой установки первичного сайта примите во внимание следующее.

- Следует провести проверку границ, групп границ и резервных отношений. Если вы назначаете клиенты новому сайту, но не изменяете границы, они могут считаться перемещаемыми. Дополнительные сведения см. в разделе [Определение границ сайта и групп границ](../configure/define-site-boundaries-and-boundary-groups.md).

- Убедитесь, что все активные клиенты переназначены другому первичному сайту в иерархии. В противном случае клиенты будут неуправляемыми после удаления сайта. Дополнительные сведения см. в статье [Назначение клиентов сайту в System Center Configuration Manager](../../../clients/deploy/assign-clients-to-a-site.md).

  - Проверьте список ролей сайта, чтобы убедиться, что новый сайт предоставляет тот же уровень обслуживания.

  - Убедитесь, что вы правильно задали размеры других систем сайта с этой ролью на другом сайте. Они должны поддерживать бизнес-требования по производительности и доступности для дополнительных клиентов.

  - Если у текущего сайта много клиентов, переназначьте их поэтапно. Отслеживайте репликацию базы данных, когда клиенты полностью обновляют данные инвентаризации и другие данные, относящиеся к конкретному сайту. При управлении обновлениями программного обеспечения клиентам будет назначена новая точка обновления программного обеспечения. Это поведение вызывает полную проверку соответствия обновлений.

  - Переназначение клиента может влиять на отчеты и запросы, основанные на данных инвентаризации, и на состояние соответствия. Рекомендуется временно поменять все клиентские циклы во время перехода.

  - Проверьте все методы назначения клиентов, чтобы убедиться, что они не ссылаются на этот первичный сайт.

- Проверьте, содержат ли активные объекты в иерархии статические ссылки на код сайта. Например, это могут быть запросы коллекции, последовательности задач или административные скрипты.

- Если в иерархии используется [резервный сайт](../configure/boundary-group-procedures.md#bkmk_site-fallback) для автоматического назначения сайта, убедитесь, что он не ссылается на этот первичный сайт.

- Перенастройте все [методы установки клиентов](../../../clients/deploy/plan/client-installation-methods.md), которые могут ссылаться на статический код сайта.

- Если на первичном сайте есть связанные с сайтом облачные службы, их необходимо удалить. Если вам все еще нужны облачные ресурсы, переместите их на другой первичный сайт в иерархии. Удалите их с первичного сайта, который вы собираетесь удалить, и добавьте их на другой первичный сайт.

- Если на текущем первичном сайте есть [методы обнаружения](../configure/run-discovery.md) для иерархии, переместите их на другой сайт.

- Выведите из эксплуатации [носители развертывания ОС](../../../../osd/deploy-use/create-task-sequence-media.md) на основе сайта.

- Удалите все роли системы сайта с сайта и сервера сайта. Дополнительные сведения см. в статье [Удаление ролей системы сайта](#bkmk_role). Хотя этот этап подготовки не является обязательным, он обеспечивает выявление дополнительных зависимостей перед удалением сайта.

- Удалите все вторичные сайты на этом первичном сайте. Дополнительные сведения см. в разделе [Вторичный сайт](#bkmk_secondary).

### <a name="prerequisites-to-uninstall-a-primary-site"></a><a name="bkmk_pri-prereq"></a> Необходимые условия отмены установки первичного сайта

Убедитесь, что пользователь-администратор, запускающий программу установки Configuration Manager, имеет следующие права безопасности:

- права локального **администратора** на сервере CAS;

- если сервер базы данных CAS находится на удалении от сервера сайта — права локального **администратора** на удаленном сервере базы данных сайта для CAS;

- права **системного администратора** базы данных сайта CAS;

- права **локального администратора** на сервере первичного сайта;

- если сервер базы данных первичного сайта находится на удалении от сервера первичного сайта — права локального **администратора** на удаленном сервере базы данных сайта для первичного сайта;

- роль безопасности **администратора инфраструктуры** или **полного администратора** на CAS.

### <a name="procedure-to-uninstall-a-primary-site"></a><a name="bkmk_pri-process"></a> Процедура отмены установки первичного сайта

Программу установки Configuration Manager можно запустить для удаления первичного сайта, которому не назначен вторичный сайт. Выполните следующую процедуру для удаления первичного сайта.

> [!TIP]
> Если сервер первичного сайта недоступен, используйте средство обслуживания иерархии на сайте центра администрирования (CAS) для удаления первичного сайта из базы данных сайта. Дополнительные сведения см. в разделе [Средство обслуживания иерархии (Preinst.exe)](../../manage/hierarchy-maintenance-tool-preinst.exe.md).

1. Запустите программу установки Configuration Manager на сервере первичного сайта одним из следующих способов.

    - В меню **Пуск** выберите пункт **Установка Configuration Manager**.

    - В каталоге *установочного носителя* Configuration Manager откройте `\SMSSETUP\BIN\X64\setup.exe`. Убедитесь, что эта версия совпадает с версией сайта.

    - В каталоге, где *установлен* Configuration Manager, откройте `\BIN\X64\setup.exe`.

1. Прочтите информацию на странице **Перед началом работы**.

1. На странице **Приступая к работе** выберите **Удалить сайт Configuration Manager**.

    > [!IMPORTANT]  
    >  Если к первичному сайту присоединены вторичные, необходимо удалить их перед удалением первичного сайта.  

1. На странице **Удаление сайта Configuration Manager** оба следующих параметра включены по умолчанию.

    - Удалить базу данных сайта с сервера первичного сайта
    - Удалить консоль Configuration Manager

1. Нажмите кнопку **Да**, чтобы подтвердить удаление первичного сайта Configuration Manager.

### <a name="uninstall-a-primary-site-that-uses-distributed-views"></a><a name="bkmk_distviews"></a> Удаление первичного сайта, использующего распределенные представления

1. Перед удалением дочернего первичного сайта необходимо отключить распределенные представления по каждому из каналов в иерархии между сайтом центра администрирования (CAS) и первичным сайтом.

1. После отключения всех распределенных представлений по каждому каналу убедитесь, что для данных с первичного сайта завершилась повторная инициализация на сайте CAS. Сведения об отслеживании инициализации данных см. в разделе [Мониторинг репликации](../../manage/monitor-replication.md).

1. После повторной инициализации данных на сайте CAS можно [удалить первичный сайт](#bkmk_pri-process).

1. После удаления первичного сайта можно перенести распределенные представления по каналам с CAS на другие первичные сайты.

    > [!IMPORTANT]
    > Если удалить первичный сайт перед отключением распределенных представлений на каждом сайте или перед тем, как данные с первичного сайта успешно пройдут повторную инициализацию на сайте CAS, репликация данных может нарушиться.

## <a name="decommission-a-hierarchy"></a><a name="bkmk_hierarchy"></a> Вывод иерархии из эксплуатации

В некоторых организациях присутствует сразу несколько иерархий из-за сделок слияния и поглощения, наличия тестовой среды или других бизнес-требований. Если вы объединяете управление в рамках одной иерархии, это действие поможет снизить затраты и сложность. Другая причина вывода иерархии из эксплуатации может быть в том, что выполняется миграция в облачную службу управления, например Microsoft Intune, и все готово для удаления локальной инфраструктуры.

Чтобы списать иерархию с несколькими сайтами, важно соблюдать последовательность удаления. Начните с удаления сайтов в нижней части иерархии, а затем продвигайтесь наверх.

1. Сначала удалите вторичные сайты, подключенные к первичным сайтам.
2. Удалите первичные сайты.
3. После удаления всех первичных сайтов можно удалить CAS.

Дополнительные сведения см. в следующих разделах.

- [Удаление вторичного сайта](#bkmk_secondary)
- [Удаление первичного сайта](#bkmk_primary)
- [Удаление сайта CAS](#bkmk_uninstall-cas)

### <a name="uninstall-the-cas"></a><a name="bkmk_uninstall-cas"></a> Удаление сайта CAS

Последним шагом в выводе иерархии из эксплуатации является удаление сайта CAS. Запустите программу установки Configuration Manager, чтобы удалить сайт CAS, у которого нет дочерних первичных сайтов.

#### <a name="prerequisites-to-uninstall-the-cas"></a>Необходимые условия удаления сайта CAS

Убедитесь, что пользователь-администратор, запускающий программу установки Configuration Manager, имеет следующие права безопасности:

- права локального **администратора** на сервере CAS;

- если сервер базы данных CAS находится на удалении от сервера сайта — права локального **администратора** на удаленном сервере базы данных сайта для CAS;

#### <a name="procedure-to-uninstall-the-cas"></a>Процедура удаления сайта CAS

1. Запустите программу установки Configuration Manager на сервере CAS одним из следующих способов.

    - В меню **Пуск** выберите пункт **Установка Configuration Manager**.

    - В каталоге *установочного носителя* Configuration Manager откройте `\SMSSETUP\BIN\X64\setup.exe`. Убедитесь, что эта версия совпадает с версией сайта.

    - В каталоге, где *установлен* Configuration Manager, откройте `\BIN\X64\setup.exe`.

1. Прочтите информацию на странице **Перед началом работы**.

1. На странице **Приступая к работе** выберите **Удалить сайт Configuration Manager**.

    > [!IMPORTANT]  
    >  Удалите все дочерние первичные сайты, прежде чем можно будет удалить CAS.  

1. На странице **Удаление сайта Configuration Manager** оба следующих параметра включены по умолчанию.

    - Удалить базу данных сайта с сервера CAS
    - Удалить консоль Configuration Manager

1. Нажмите кнопку **Да**, чтобы подтвердить удаление сайта CAS в Configuration Manager.

## <a name="remove-the-cas"></a><a name="bkmk_remove-cas"></a> Удаление сайта CAS

<!-- 3607277 -->

Начиная с версии 2002, если иерархия состоит из CAS и одного дочернего первичного сайта, можно удалить CAS. Это действие сводит инфраструктуру Configuration Manager к одному автономному первичному сайту. Это позволяет устранить сложность репликации типа "сеть — сеть" и разместить задачи управления на одном сайте.

Дополнительные сведения см. в разделе [Удаление CAS](remove-central-administration-site.md).
