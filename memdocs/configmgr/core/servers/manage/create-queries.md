---
title: Создание запросов
titleSuffix: Configuration Manager
description: Узнайте, как создавать и импортировать запросы в Configuration Manager. Приводятся примеры запросов и советы.
ms.date: 05/08/2019
ms.prod: configuration-manager
ms.technology: configmgr-core
ms.topic: conceptual
ms.assetid: 868049d3-3209-47ec-b34a-9cc26941893a
author: aczechowski
ms.author: aaroncz
manager: dougeby
ms.openlocfilehash: 05b77fa181da67858c30f48fc8045c20384953ce
ms.sourcegitcommit: bbf820c35414bf2cba356f30fe047c1a34c5384d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/21/2020
ms.locfileid: "81703452"
---
# <a name="create-queries-in-configuration-manager"></a>Создание запросов в Configuration Manager

*Область применения: Configuration Manager (Current Branch)*

В этой статье описано, как создавать и импортировать запросы в Configuration Manager.  

##  <a name="create-a-query"></a><a name="BKMK_Create"></a> Создание запроса  
 Ниже приведена процедура создания запросов в Configuration Manager.  

1.  В консоли Configuration Manager щелкните **Мониторинг**.  

2.  В рабочей области **Мониторинг** выберите **Запросы**. На вкладке **Главная** в группе **Создать** щелкните **Создать запрос**.  

3.  На вкладке **Общие** окна **Мастер создания запросов** укажите уникальное имя и необязательный комментарий для запроса.  

4.  Чтобы импортировать имеющийся отчет и использовать его в качестве основы для нового запроса, выберите **Импортировать инструкцию запроса**. В диалоговом окне **Обзор запроса** выберите имеющийся запрос, который требуется импортировать, и нажмите кнопку **ОК**.  

5.  В списке **Тип объекта** выберите тип объекта, для которого требуется выполнить запрос. В приведенной ниже таблице описаны некоторые примеры типов объектов, по которым вы можете выполнять поиск.  

    |Тип объекта|Описание:|  
    |-----------------|-----------------|  
    |**Системный ресурс**|Используйте для поиска типичных системных атрибутов, таких как NetBIOS-имя устройства, версия клиента, IP-адрес клиента и сведения доменных служб Active Directory.|  
    |**Ресурс пользователя**|Используйте для поиска стандартной информации о пользователе, например имени пользователя, имени группы пользователя и имени группы безопасности.|  
    |**Развертывание**|Используйте для поиска стандартных атрибутов развертывания, таких как имя развертывания, а также расписание и коллекция, в которую выполнено развертывание.|  

6.  Выберите **Изменить инструкцию запроса**, чтобы открыть диалоговое окно **Свойства инструкции** &lt;имя_запроса\>.  

7.  На вкладке **Общие** диалогового окна **Свойства инструкции** &lt;имя_запроса\> укажите атрибуты, возвращаемые этим запросом, и способ их отображения. Щелкните значок **Создать**, чтобы добавить новый атрибут. Кроме того, вы можете щелкнуть пункт **Показать язык запроса**, чтобы ввести или изменить запрос непосредственно на языке запросов WMI. Примеры запросов WMI см. в разделе [Примеры запросов WQL](#BKMK_Example) этой статьи.  

    > [!TIP]  
    > Следующую справочную документацию можно использовать для создания собственных запросов WQL:  
    >   
    > -   [WQL (SQL для WMI)](https://go.microsoft.com/fwlink/p/?LinkId=256653)  
    > -   [Предложения WHERE](https://go.microsoft.com/fwlink/p/?LinkId=256654)  
    > -   [Операторы WQL](https://go.microsoft.com/fwlink/p/?LinkId=256655)  

8.  На вкладке **Критерии** диалогового окна &lt;Свойства инструкции\> **имя_запроса** укажите критерии, которые используются для уточнения результатов запроса. Например, вы можете вернуть только ресурсы с кодом сайта **XYZ**. Можно настроить несколько условий для запроса.  

    > [!IMPORTANT]  
    > Если вы создаете запрос, который не содержит условий, он возвратит все устройства в коллекции **Все системы** .  

9. На вкладке **Объединения** диалогового окна **Свойства инструкции** &lt;имя_запроса\> можно объединить данные двух разных атрибутов в результатах запроса. Несмотря на то, что Configuration Manager автоматически создает объединения при выборе различных атрибутов для результата запроса, вкладка **Объединения** предоставляет расширенные параметры. Configuration Manager поддерживает следующие классы атрибутов:  

    |Тип объединения|Описание:|  
    |---------------|-----------------|  
    |Внутренний|Отображение только подходящих результатов. Этот вариант всегда используется в объединениях, создаваемых автоматически.|  
    |Left|Отображение всех результатов для базового атрибута и только подходящих результатов для атрибута объединения.|  
    |Правый|Отображение всех результатов для атрибута объединения и только подходящих результатов для базового атрибута.|  
    |Полная архивация|Отображение всех результатов для базового атрибута и атрибута объединения.|  

     Дополнительные сведения о том, как использовать операции объединения, см. в документации к серверу SQL Server.  

10. Нажмите кнопку **ОК**, чтобы закрыть диалоговое окно &lt;Свойства инструкции\> **имя_запроса**.  

11. На вкладке **Общие** окна **Мастер создания запросов** укажите, будут ли ограничены результаты этого запроса членами коллекции или указанной коллекции либо будет ли предлагаться указать коллекцию при каждом выполнении запроса.  

12. Следуйте указаниям мастера для создания запроса. Новый запрос отображается в узле **Запросы** рабочей области **Мониторинг**.  

##  <a name="import-a-query"></a><a name="BKMK_Import"></a> Импорт запроса  
 Ниже приведена процедура импорта запроса в Configuration Manager. Сведения о том, как экспортировать запросы, см. в разделе [Управление запросами](../../../core/servers/manage/manage-queries.md).  

1.  В консоли Configuration Manager щелкните **Мониторинг**.  

2.  В рабочей области **Мониторинг** выберите **Запросы**. На вкладке **Главная** в группе **Создать** щелкните **Импорт объектов**.  

3.  На странице **Имя MOF-файла** **мастера импорта объектов** нажмите кнопку **Обзор** и выберите MOF-файл, содержащий запрос, который требуется импортировать.  

4.  Просмотрите сведения об импортируемом запросе, после чего завершите работу мастера. Новый запрос отображается в узле **Запросы** рабочей области **Мониторинг**.  

##  <a name="example-wql-queries"></a><a name="BKMK_Example"></a> Example WQL queries

Этот раздел содержит примеры запросов WQL, которые вы можете использовать в иерархии или изменять для применения в других целях. Чтобы использовать эти запросы, в диалоговом окне **Свойства формы запроса** щелкните **Показать язык запроса**. Затем скопируйте и вставьте запрос в поле **Инструкция запроса**.  

> [!TIP]  
> Используйте подстановочный знак `%` для обозначения любой строки символов. Например, `%Visio%` возвращает Microsoft Office Visio 2010.  

### <a name="computers-that-run-windows-10"></a>Компьютеры под управлением Windows 10

Используйте следующий запрос для возврата NetBIOS-имени и версии операционной системы всех компьютеров под управлением Windows 7.  

``` WQL
select SMS_R_System.NetbiosName,  
SMS_R_System.OperatingSystemNameandVersion from
SMS_R_System where
SMS_R_System.OperatingSystemNameandVersion like "%Workstation 10%"  
```  

### <a name="computers-with-a-specific-software-package-installed"></a>Компьютеры с установленным указанным пакетом программного обеспечения  

Используйте следующий запрос для возврата NetBIOS-имени и имени пакета программного обеспечения всех компьютеров, на которых установлен указанный пакет программного обеспечения. В этом примере отображаются все компьютеры с установленной версией Microsoft Visio. Замените `Microsoft%Visio%` пакетом программного обеспечения, для которого требуется запросить данные.  

> [!TIP]  
> Этот запрос выполняет поиск пакета программного обеспечения с помощью имен, отображаемых в списке программ на панели управления Windows.  

``` WQL
select SMS_R_System.NetbiosName,
SMS_G_System_ADD_REMOVE_PROGRAMS.DisplayName from
SMS_R_System inner join SMS_G_System_ADD_REMOVE_PROGRAMS on
SMS_G_System_ADD_REMOVE_PROGRAMS.ResourceId =
SMS_R_System.ResourceId where
SMS_G_System_ADD_REMOVE_PROGRAMS.DisplayName like "Microsoft%Visio%"  
```  

### <a name="computers-in-a-specific-active-directory-domain-services-organizational-unit"></a>Компьютеры в указанном подразделении доменных служб Active Directory

Используйте запрос ниже для возврата NetBIOS-имени и имени подразделения всех компьютеров в указанном подразделении. Замените текст `OU Name` именем подразделения, для которого требуется запросить данные.  

``` WQL
select SMS_R_System.NetbiosName,
SMS_R_System.SystemOUName from
SMS_R_System where
SMS_R_System.SystemOUName = "OU Name"  
```  

### <a name="computers-with-a-specific-netbios-name"></a>Компьютеры с определенным NetBIOS-именем

Используйте следующий запрос для возврата NetBIOS-имени всех компьютеров, начинающихся с определенной строки символов. В этом примере запрос возвращает все компьютеры с NetBIOS-именем, которое начинается с `ABC`.  

``` WQL
select SMS_R_System.NetbiosName from
SMS_R_System where SMS_R_System.NetbiosName like "ABC%"  
```  

###  <a name="devices-of-a-specific-type"></a><a name="BKMK_DeviceType"></a> Устройства определенного типа

Типы устройств сохраняются в базе данных Configuration Manager по классу ресурсов **sms_r_system** и имени атрибута **AgentEdition**. Используйте следующий запрос, чтобы получить только те устройства, которые соответствуют выпуску агента указанного типа устройства:  

``` WQL
Select SMS_R_System.ClientEdition from SMS_R_System where SMS_R_System.ClientEdition = <Device ID>  
```  

Используйте одно из указанных ниже значений для &lt;идентификатора устройства\>.  

|Тип устройства|Значение AgentEdition|  
|-----------------|---------------------------|  
|Настольный компьютер или ноутбук под управлением Windows|0|  
|Устройство на базе Windows ARM (под управлением Windows RT)|1|  
|Windows Mobile 6.5|2|  
|Nokia Symbian|3|  
|Windows Phone|4|  
|Компьютеры Mac|5|  
|Windows CE|6|  
|Windows Embedded|7|  
|Система на микросхеме Intel|12|  
|Серверы Unix и Linux|13|  
|Microsoft HoloLens (MDM)|15|
|Microsoft Surface Hub (MDM)|16|

> [!NOTE]
> Значения, неуказанные в этой таблице, связаны с устройствами, которые больше не поддерживаются.

<!-- removed with hybrid EOL
|iOS|8|  
|iPad|9|  
|iPod touch|10|  
|Android|11|  
|Apple macOS (MDM)|14|
|Android for Work|17|
 -->

Например, если необходимо вернуть только компьютеры Mac, используйте следующий запрос:  

``` WQL
Select SMS_R_System.ClientEdition from SMS_R_System where SMS_R_System.ClientEdition = 5  
```  

## <a name="next-steps"></a>Дальнейшие шаги

[Управление запросами](manage-queries.md)
