---
author: mestew
ms.author: mstewart
ms.prod: configuration-manager
ms.technology: configmgr-core
ms.topic: include
ms.date: 09/26/2019
ms.openlocfilehash: 69ec772da4b5c7696bc5234984910dd7065656ca
ms.sourcegitcommit: bbf820c35414bf2cba356f30fe047c1a34c5384d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/21/2020
ms.locfileid: "81697722"
---
## <a name="orchestration-groups"></a><a name="bkmk_OGs"></a> Группы оркестрации

<!--3098816-->

Создайте группу оркестрации, чтобы эффективнее управлять развертыванием обновлений программного обеспечения на устройствах. Многие администраторы сервера должны внимательно управлять обновлениями для конкретных рабочих нагрузок и автоматизировать поведение между ними. Пример.

- Администратор обновлений программного обеспечения управляет всеми обновлениями в организации.
- У вас есть крупная коллекция для всех серверов и крупная коллекция для всех клиентов. Все обновления развертываются в рамках этих коллекций.
- Администраторы SQL должны управлять всем программным обеспечением, установленным на серверах SQL Server. Им требуется обновить пять серверов в определенном порядке. Текущий процесс заключается в ручном отключении определенных служб перед установкой обновлений и последующем перезапуске служб.
- Создайте группу оркестрации и добавьте все пять серверов SQL Server. Добавьте также предварительные и последующие скрипты с помощью скриптов PowerShell, предоставленных администраторами SQL.
- Во время следующего цикла обновления вы создадите и развернете обновления программного обеспечения для большой коллекции серверов как обычно. Администраторы SQL запускают развертывание, а группа оркестрации автоматизирует порядок и службы.

Группа оркестрации обеспечивает гибкие возможности обновления устройств на основе процента, определенного числа или явного порядка. Вы также можете запустить скрипт PowerShell до и после того, как устройства запускают развертывание обновлений.

Членами группы оркестрации может быть любой клиент Configuration Manager, а не только серверы. Правила группы оркестрации применяются к устройствам для всех развертываний обновлений программного обеспечения в любой коллекции, в которой содержится участник группы оркестрации. Другие поведения развертывания применяются по-прежнему. Например, периоды обслуживания и расписания развертывания.

> [!NOTE]
> Функция **Группы оркестрации** — это эволюция функции [Группы серверов](../../../../../sum/deploy-use/service-a-server-group.md). Группа оркестрации — это новый объект в Configuration Manager.

### <a name="prerequisites"></a>Предварительные условия

- Включите функцию **Группы оркестрации**. Дополнительные сведения см. в разделе [Включение дополнительных функций из обновлений](../../../../servers/manage/install-in-console-updates.md#bkmk_options).

    > [!NOTE]
    > При включении функции **Группы оркестрации** сайт отключает функцию **Группы серверов**. Такое поведение позволяет избежать конфликтов между двумя функциями.

- Чтобы просмотреть все группы оркестрации и обновления для этих групп, ваша учетная запись должна иметь роль **Полный администратор**.

### <a name="try-it-out"></a>Попробуйте!

Попробуйте выполнить следующие задачи, а после этого [поделитесь с нами своим мнением](../../../../understand/find-help.md#product-feedback) об этой функции.

1. В консоли Configuration Manager перейдите к рабочей области **Активы и соответствие** и выберите узел **Группа оркестрации**.

1. На ленте выберите **Создать группу оркестрации**, чтобы открыть **мастер создания групп оркестрации**.

1. На странице **Общие сведения** укажите группу оркестрации, **имя** и **описание** (необязательно).

1. На странице **Выбор пользователя** сначала укажите текущий **код сайта**. Затем нажмите кнопку **Обзор**, чтобы добавить ресурсы устройства в качестве членов этой группы оркестрации. **Выполните поиск** устройств по имени, а затем **добавьте** их. Добавив устройства в список выбранных ресурсов, нажмите кнопку **ОК**.

    ![Снимок экрана: окно выбора ресурсов в группе оркестрации](../../media/3098816-select-resources.png)

1. На странице **Выбор правил** выберите один из следующих параметров:

   - **Разрешите одновременное обновление компьютеров в процентах**, а затем выберите или введите число процента. Используйте этот параметр, чтобы обеспечить гибкость размера группы оркестрации в будущем. Например, в группе оркестрации содержится 50 устройств и вы указываете значение 10. Во время развертывания обновлений программного обеспечения Configuration Manager позволит запускать развертывание пяти устройствам одновременно. Если позже вы увеличите размер группы оркестрации до 100 устройств, то одновременно будут обновляться 10 устройств.

   - **Разрешите одновременное обновление нескольких компьютеров**, а затем выберите или введите определенное число. Используйте этот параметр, чтобы постоянно ограничивать выборку до определенного количества устройств, независимо от общего размера группы оркестрации.

   - **Укажите последовательность обслуживания**, а затем отсортируйте выбранные ресурсы в правильном порядке. Используйте этот параметр, чтобы явно указать порядок, в котором устройства запускают развертывание обновлений программного обеспечения.

1. На странице **PreScript** введите скрипт PowerShell для запуска на каждом устройстве *перед* выполнением развертывания. Скрипт должен возвращать значение `0` для успешного выполнения или `3010` для успешного выполнения при перезапуске. Вы также можете указать значение **времени ожидания скрипта**, которое не позволяет выполнить скрипт в указанное время.

1. На странице **PostScript** введите скрипт PowerShell для запуска на каждом устройстве *после* выполнения развертывания. В противном случае поведение будет совпадать с PreScript.

1. Выполните указания мастера.

В узле **Группа оркестрации** выберите группу оркестрации. На ленте щелкните **Показать участников**. Вы увидите участников группы и состояние их оркестрации.

Чтобы проверить поведение группы оркестрации, [разверните обновления программного обеспечения](../../../../../sum/deploy-use/deploy-software-updates.md) в коллекцию, содержащую участников группы оркестрации. Оркестрация запускается, когда любой клиент в группе пытается установить обновление программного обеспечения в крайний срок или в течение периода обслуживания. Она начинается для всей группы и гарантирует, что устройства обновляются, следуя правилам группы оркестрации.

> [!TIP]
> Группы оркестрации применяются только к развертываниям обновлений программного обеспечения. Они не применяются к другим развертываниям.

### <a name="monitor"></a>Монитор

Используйте следующие файлы журналов на сервере сайта для помощи при мониторинге и устранении неполадок:

- **Policypv.log** — указывает, что сайт назначается группе оркестрации клиентам.
- **SMS_OrchestrationGroup.log** — указывает поведение группы оркестрации.

### <a name="orchestration-group-known-issues"></a>Известные проблемы групп оркестрации

- Не добавляйте компьютер в несколько групп оркестрации.

- При поиске в коллекции для выбора ресурсов группы оркестрации выбирайте только значение **Все клиенты — настольные компьютеры и серверы**.

- В группе оркестрации доступно несколько действий, но работает только действие по умолчанию **Показать участников**. В настоящее время это действие не отображает имя устройства, а только идентификатор ресурса.

- Значения **типа оркестрации** соответствуют следующим типам:

    | Значение | Тип оркестрации |
    |-------|---------|
    |**1**|Число|
    |**2**|Процент|
    |**3**|Последовательность|

- Значения **Текущее состояние** соответствуют следующим состояниям:

    | Значение | Текущее состояние |
    |-------|---------|
    |**1**|Бездействие|
    |**2**|Устройство ожидает свою очередь|
    |**3**|Выполняется установка обновления|
    |**4**|Сбой|
    |**5**|Ожидается перезагрузка|
