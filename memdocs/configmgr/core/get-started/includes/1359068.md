---
author: aczechowski
ms.author: aaroncz
ms.prod: configuration-manager
ms.topic: include
ms.date: 09/07/2018
ms.openlocfilehash: b63c50c78e8a30a3a6a57f0f8ef06a3161b80c73
ms.sourcegitcommit: bbf820c35414bf2cba356f30fe047c1a34c5384d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/21/2020
ms.locfileid: "81695822"
---
## <a name="improvements-to-cmpivot"></a><a name="bkmk_cmpivot"></a> Улучшения CMPivot
<!--1359068-->

В CMPivot внесены следующие усовершенствования.  
- [Скалярные функции](#bkmk_cmpivot-functions)  
- [Отрисовка визуализаций](#bkmk_cmpivot-charts)  
- [Инвентаризация оборудования](#bkmk_cmpivot-hinv)  
- [Скалярные операторы](#bkmk_cmpivot-operators)  
- [Сводка по запросу](#bkmk_cmpivot-summary)  

Дополнительные сведения см. в статье о [CMPivot](../../servers/manage/cmpivot.md).


### <a name="scalar-functions"></a><a name="bkmk_cmpivot-functions"></a> Скалярные функции
CMPivot поддерживает следующие скалярные функции.
- **ago()** . Вычитает данный временной диапазон из текущего времени в формате UTC.  
- **datetime_diff()** . Вычисляет календарную разницу между двумя значениями даты и времени.  
- **now()** . Возвращает текущее время в формате UTC.  
- **bin()** . Округляет значения в меньшую сторону до целого значения, кратного заданному размеру ячейки.  

> [!Note]  
> Тип данных datetime представляет момент времени, обычно выраженный в виде даты и времени суток. Значения времени измеряются в единицах, равных 1 секунде. Значение даты и времени всегда указывается в часовом поясе UTC. Литералы даты и времени всегда следует выражать в формате ISO 8601, например `yyyy-mm-dd HH:MM:ss`.  

#### <a name="examples"></a>Примеры
- `datetime(2015-12-31 23:59:59.9)`: определенный литерал даты и времени   
- `now()`: текущее время  
- `ago(1d)`: текущее время минус один день  


### <a name="rendering-visualizations"></a><a name="bkmk_cmpivot-charts"></a> Отрисовка визуализаций

Теперь в CMPivot доступна базовая поддержка [оператора отрисовки](https://docs.microsoft.com/azure/kusto/query/renderoperator) Log Analytics. Эта поддержка распространяется на следующие типы.  
- **barchart**. Первый столбец является осью X и может иметь тип text, datetime или numeric. Второй столбец должен иметь тип numeric и отображается в виде горизонтальной полосы.  
- **columnchart**. Аналогичен barchart с вертикальными полосами вместо горизонтальных.  
- **piechart**. Первый столбец — это ось цвета, второй столбец имеет тип numeric.  
- **timechart**. Линейный график. Первый столбец — это ось X с типом данных datetime. Второй столбец — это ось Y.  

#### <a name="example-bar-chart"></a>Пример: линейчатая диаграмма.
Следующий запрос отображает недавно использовавшиеся приложения в виде линейчатой диаграммы.

``` Kusto
CCMRecentlyUsedApplications
| summarize dcount( Device ) by ProductName
| top 10 by dcount_
| render barchart
```

![Пример визуализации линейчатой диаграммы CMPivot](../media/1359068-cmpivot-barchart.png)

#### <a name="example-time-chart"></a>Пример: диаграмма времени
Для визуализации диаграмм времени используйте новый **bin()** оператор, позволяющий группировать события во времени. Следующий запрос отображает время запуска устройств в течение последних семи дней.

``` Kusto
OperatingSystem
| where LastBootUpTime <= ago(7d)
| summarize count() by bin(LastBootUpTime,1d)
| render timechart
```

![Пример визуализации диаграммы времени CMPivot](../media/1359068-cmpivot-timechart.png)

#### <a name="example-pie-chart"></a>Пример: круговая диаграмма.
Следующий запрос отображает все версии ОС на круговой диаграмме.

``` Kusto
OperatingSystem
| summarize count() by Caption
| render piechart
```

![Пример визуализации круговой диаграммы CMPivot](../media/1359068-cmpivot-piechart.png)


### <a name="hardware-inventory"></a><a name="bkmk_cmpivot-hinv"></a> Инвентаризация оборудования
Используйте CMPivot для запроса любого класса инвентаризации оборудования. Эти классы содержат любые пользовательские расширения, внесенные в инвентаризацию оборудования. CMPivot немедленно возвращает кэшированные результаты из последней проверки инвентаризации оборудования, хранящейся в базе данных сайта. В то же время он при необходимости обновляет результаты динамическими данными с клиентов в сети.

Насыщенность цвета данных в таблице результатов или на диаграмме означает вид данных — динамические или кэшированные. Например, темно-синим цветом показаны данные в режиме реального времени от клиента в сети. Светло-синим цветом выделены кэшированные данные.

#### <a name="example"></a>Пример

``` Kusto
LogicalDisk
| summarize sum( FreeSpace ) by Device
| order by sum_ desc
| render columnchart
```

![Пример запроса инвентаризации CMPivot с визуализацией в виде гистограммы](../media/1359068-cmpivot-inventory.png)

#### <a name="limitations"></a>Ограничения
- Не поддерживаются следующие сущности инвентаризации оборудования:  
    - свойства массива, например IP-адрес;  
    - Real32/Real64; <!--example?-->  
    - свойства внедренного объекта. <!--example?-->  
- Имена сущностей инвентаризации должны начинаться с символа.
- Перезаписать встроенные сущности путем создания сущности инвентаризации с тем же именем невозможно.  


### <a name="scalar-operators"></a><a name="bkmk_cmpivot-operators"></a> Скалярные операторы
С учетом ваших отзывов теперь CMPivot включает в себя следующие скалярные операторы.  

> [!Note]  
> - LHS: строка слева от оператора  
> - RHS: строка справа от оператора  


|оператора|Описание|Пример (возвращает true)|
|--------|-----------|---------------------|
|==|Равно|`"aBc" == "aBc"`|
|!=|Не равно|`"abc" != "ABC"`|
|like|LHS содержит совпадение для RHS|`"FabriKam" like "%Brik%"`|
|!like|LHS не содержит совпадение для RHS|`"Fabrikam" !like "%xyz%"`|
|содержит|RHS возникает как последовательность LHS|`"FabriKam" contains "BRik"`|
|!contains|RHS не возникает в LHS|`"Fabrikam" !contains "xyz"`|
|startswith|RHS является начальной последовательностью LHS|`"Fabrikam" startswith "fab"`|
|!startswith|RHS не является начальной последовательностью LHS|`"Fabrikam" !startswith "kam"`|
|endswith|RHS является закрывающей последовательностью LHS|`"Fabrikam" endswith "Kam"`|
|!endswith|RHS не является закрывающей последовательностью LHS|`"Fabrikam" !endswith "brik"`|


### <a name="query-summary"></a><a name="bkmk_cmpivot-summary"></a> Сводка по запросу
В нижней части окна CMPivot откройте вкладку **Сводка по запросу**. Это состояние поможет вам определить клиенты, которые находятся в автономном режиме, или устранить возможные ошибки. Выберите значение в столбце Count, чтобы открыть список конкретных устройств с этим состоянием. 

Например, выберите число устройств с состоянием "Сбой". Просмотрите конкретное сообщение об ошибке и экспортируйте список этих устройств. Если ошибка заключается в невозможности распознать определенный командлет, создайте коллекцию из экспортированного списка устройств для развертывания обновления Windows PowerShell.  
