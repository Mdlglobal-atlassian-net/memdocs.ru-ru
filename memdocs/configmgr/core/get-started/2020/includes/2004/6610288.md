---
author: aczechowski
ms.author: aaroncz
ms.prod: configuration-manager
ms.technology: configmgr-core
ms.topic: include
ms.date: 04/30/2020
ms.openlocfilehash: 909e40c31da2e6642a1559d055c52bfde1c18fd0
ms.sourcegitcommit: 56bb5419c41c2e150ffed0564350123135ea4592
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/02/2020
ms.locfileid: "82729385"
---
## <a name="improvement-to-format-and-partition-disk-task-sequence-step"></a><a name="bkmk_osdpart"></a> Улучшение этапа последовательности задач "Отформатировать диск и создать разделы"

<!--6610288-->

Благодаря [отзывам на UserVoice](https://configurationmanager.uservoice.com/forums/300492-ideas/suggestions/34167106-disk-number-variable-for-format-and-partition-disk) была добавлена возможность задавать целевой диск для этапа **Отформатировать диск и создать разделы** с помощью переменной последовательности задач. Этот новый переменный параметр поддерживает более сложные последовательности задач с динамическим поведением. Например, пользовательский скрипт может обнаружить диск и задать переменную на основе типа оборудования. Это позволяет использовать несколько экземпляров данного этапа для настройки различных типов и разделов оборудования.

Ниже продемонстрирован один из примеров с использованием макета этапов.

- **Запустить сценарий PowerShell**. Пользовательский скрипт для сбора данных о целевых дисках.
  - Задает для `myOSDisk` значение `1`.
  - Задает для `myDataDisk` значение `2`.

- **Отформатировать диск и создать разделы** для диска операционной системы. Определяет переменную `myOSDisk`.
  - Настраивает диск 1 в качестве системного.

- **Отформатировать диск и создать разделы** для диска данных. Определяет переменную `myDataDisk`.
  - Настраивает диск 2 для хранения необработанных данных.

В разновидности этого примера используются номера дисков и планы создания разделов для различных типов оборудования.

> [!NOTE]
> При этом можно по-прежнему использовать имеющуюся переменную последовательности задач **OSDDiskIndex**. Однако в таком случае для каждого экземпляра этапа **Отформатировать диск и создать разделы** будет использоваться одно и то же значение. Если требуется программно задать номер диска для нескольких экземпляров данного этапа, используйте этот новый параметр.

Чтобы настроить его на этапе **Отформатировать диск и создать разделы**, выберите **Variable name to store disk number** (Имя переменной для хранения номера диска), а затем введите имя пользовательской переменной. Добавьте предыдущий этап в последовательность задач, чтобы задать для этой пользовательской переменной целочисленное значение, соответствующее физическому диску.
