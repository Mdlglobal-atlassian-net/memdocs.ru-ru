---
title: Управление образами ОС
titleSuffix: Configuration Manager
description: Изучите методы управления образами ОС, которые хранятся в файлах образов Windows (WIM).
ms.date: 07/26/2019
ms.prod: configuration-manager
ms.technology: configmgr-osd
ms.topic: conceptual
ms.assetid: fab13949-371c-4a4c-978e-471db1e54966
author: aczechowski
ms.author: aaroncz
manager: dougeby
ms.openlocfilehash: 190a203494cecfd28c198197f3a582adff745265
ms.sourcegitcommit: bbf820c35414bf2cba356f30fe047c1a34c5384d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/21/2020
ms.locfileid: "81708892"
---
# <a name="manage-os-images-with-configuration-manager"></a>Управление образами ОС с помощью Configuration Manager

*Область применения: Configuration Manager (Current Branch)*

Образы ОС в Configuration Manager хранятся в формате образов Windows (WIM). Эти образы представляют собой набор сжатых эталонных файлов и папок; они используются для установки и настройки новой ОС на компьютере. Множеству сценариев развертывания операционной системы требуется образ операционной системы.


## <a name="os-image-types"></a>Типы образов ОС

Вы можете использовать [образ операционной системы по умолчанию](#default-image) или создать образ операционной системы на настроенном [эталонном компьютере](#bkmk_capture). При создании компьютера-образца добавляются файлы операционной системы, драйверы, файлы поддержки, обновления программного обеспечения, средства и приложения операционной системы. Затем следует записать его для создания файла образа.

### <a name="default-image"></a>Образ по умолчанию

Файлы установки Windows включают образ операционной системы по умолчанию. Этот образ является базовым образом операционной системы, содержащим стандартный набор драйверов. При использовании образа операционной системы по умолчанию используйте шаги последовательности задач для установки приложения и выполните другие настройки после установки операционной системы на устройстве. Найдите образ операционной системы по умолчанию в исходных файлах Windows: `\Sources\install.wim`.  

#### <a name="default-image-advantages"></a>Преимущества образа по умолчанию

- Размер образа меньше размера записанного образа.  

- Установка приложений и выполнение конфигураций с использованием шагов последовательности задач является более динамичным процессом. Например, вы можете изменить конфигурации и приложения, которые будут установлены в последовательности задач, без необходимости переустанавливать образ устройства.  

#### <a name="default-image-disadvantages"></a>Недостатки образа по умолчанию

- Установка операционной системы может занять больше времени. Установка приложений и других конфигураций происходит после установки операционной системы.  


### <a name="captured-image-from-a-reference-computer"></a><a name="bkmk_capture"></a> Записанный образ компьютера-образца

Чтобы создать настраиваемый образ ОС, соберите компьютер-образец с нужной ОС. Затем установите приложения и настройте параметры. Запишите образ операционной системы с компьютера-образца, чтобы создать WIM-файл. Компьютер-образец можно настроить вручную или использовать последовательность задач для автоматизации необходимых этапов. Дополнительные сведения см. в статье [Настройка образов ОС](customize-operating-system-images.md).  

#### <a name="captured-image-advantages"></a>Преимущества записанного образа

- В этом случае установка может занимать меньше времени, чем установка с использованием образа по умолчанию. Например, приложения могут быть уже установлены на записанном образе операционной системы. Не нужно устанавливать те же приложения позже с помощью последовательности задач.  

#### <a name="captured-image-disadvantages"></a>Недостатки записанного образа

- Размер образа потенциально превышает размер образа по умолчанию.  

- Потребуется создать новый образ, когда нужно будет установить обновления для приложений и инструментов.  


## <a name="add-an-os-image"></a><a name="BKMK_AddOSImages"></a> Добавление образа операционной системы  

Прежде чем использовать образ ОС, добавьте его на сайт Configuration Manager.

1. В консоли Configuration Manager перейдите к рабочей области **Библиотека программного обеспечения**, разверните узел **Операционные системы** и выберите **Образы ОС**.  

2. На вкладке **Главная** ленты в группе **Создать** выберите **Добавить образ операционной системы**. Это действие запускает мастер добавления образа операционной системы.  

3. На странице **Источник данных** укажите следующие сведения:

    - Сетевой **путь** к файлу образа операционной системы. Например, `\\server\share\path\image.wim`.

    - Выберите параметр **Извлечь конкретный индекс образа из выбранного WIM-файла**, а затем выберите нужный индекс образа в списке.<!--3719699--> Начиная с версии 1902 этот параметр автоматически импортирует один индекс, а не все индексы образов в файле. При использовании этого параметра создается файл меньшего размера, что позволяет ускорить автономное обслуживание. Он также поддерживает процесс [оптимизации обслуживания образов](#bkmk_resetbase), создавая файл меньшего размера после применения обновлений программного обеспечения.  

        > [!Note]  
        > Configuration Manager не изменяет исходный файл образа. В том же рабочем каталоге создается новый файл образа.
        >
        > Этот процесс извлечения может завершиться ошибкой для очень больших файлов образов (например, более 60 ГБ). Ошибка DISM: `Not enough storage is available to process this command.`. Командная строка, которую использует Configuration Manager, находится в файле smsprov.log и dism.log. Вручную выполните ту же команду, а затем импортируйте образ.<!-- SCCMDocs-pr issue 3502 -->  

    - Начиная с версии 1906, если требуется предварительное кэширование содержимого на клиенте, укажите **архитектуру** и **язык** образа. Дополнительные сведения см. в разделе [Настройка предварительного кэширования содержимого](../deploy-use/configure-precache-content.md).<!--4224642-->  

4. На странице **Общие** укажите перечисленные ниже сведения. Эти данные используются для идентификации при наличии нескольких образов ОС.  

    - **Имя** — уникальное имя образа. По умолчанию имя берется из имени WIM-файла.  

    - **Версия**. Необязательный идентификатор версии. Это свойство необязательно должно соответствовать версии операционной системы образа. Часто это бывает версия пакета в вашей организации.  

    - **Комментарий**. Необязательное краткое описание.  

5. Завершите работу мастера.  

Сведения о командлете PowerShell, выполняющем функции этого мастера, см. в статье [New-CMOperatingSystemImage](https://docs.microsoft.com/powershell/module/configurationmanager/new-cmoperatingsystemimage?view=sccm-ps).

Затем нужно распространить образ загрузки в точки распространения.  


## <a name="distribute-content-to-distribution-points"></a><a name="BKMK_DistributeBootImages"></a> Передайте содержимое в точки распространения  

Распространение образов операционной системы в точки распространения производится так же, как и для другого содержимого. Перед развертыванием последовательности задач необходимо распространить образ операционной системы по крайней мере в одну точку распространения. Дополнительные сведения см. в разделе [Распространение содержимого](../../core/servers/deploy/configure/deploy-and-manage-content.md#bkmk_distribute).  


[!INCLUDE [Apply software updates to an image](includes/wim-apply-updates.md)]


## <a name="prepare-the-os-image-for-multicast-deployments"></a><a name="BKMK_OSImageMulticast"></a> Подготовка образа операционной системы для многоадресных развертываний  

Многоадресные развертывания позволяют нескольким компьютерам одновременно загружать образ операционной системы. Точка распространения отправляет образ клиентам в режиме многоадресной рассылки. Клиенты не скачивают копии образа с точки распространения по отдельному каналу. При выборе метода развертывания операционной системы [Использование многоадресной рассылки для развертывания Windows по сети](../deploy-use/use-multicast-to-deploy-windows-over-the-network.md) необходима настройка образа операционной системы для поддержки многоадресной рассылки. Затем передайте загрузочный образ в точки распространения с поддержкой многоадресной рассылки.

1. В консоли Configuration Manager перейдите к рабочей области **Библиотека программного обеспечения**, разверните узел **Операционные системы** и выберите **Образы ОС**.  

2. Выберите образ операционной системы, который будет распространяться точкой распространения, поддерживающей многоадресную рассылку.  

3. На вкладке ленты **Главная** в группе **Свойства** выберите **Свойства**.  

4. Перейдите на вкладку **Параметры распространения** и настройте следующие параметры:  

    - **Разрешить передачу этого пакета через многоадресную рассылку (только WinPE)** . Выберите этот параметр, чтобы позволить Configuration Manager развертывать образы операционной системы одновременно с помощью многоадресной рассылки.  

    - **Шифровать пакеты многоадресной рассылки**. Укажите, требуется ли шифрование образа сайтом перед его отправкой на точку распространения. Этот параметр следует использовать, если пакет содержит конфиденциальную информацию. Если образ не шифруется, его содержимое передается в виде открытого текста в сети. При этом неавторизованный пользователь может перехватывать и просматривать содержимое образа.  

    - **Передавать этот пакет только через многоадресную рассылку**. Укажите, должна ли точка распространения развертывать образ только посредством многоадресной рассылки.  

         При выборе параметра **Передавать этот пакет только через многоадресную рассылку** необходимо также указать и параметр **Загружать содержимое локально, если это требуется для выполняющейся последовательности задач** в качестве параметра развертывания для последовательности задач. Дополнительные сведения см. в статье [Deploy a task sequence](../deploy-use/deploy-a-task-sequence.md).  

5. Нажмите **ОК**, чтобы сохранить параметры и закрыть свойства образа.  
