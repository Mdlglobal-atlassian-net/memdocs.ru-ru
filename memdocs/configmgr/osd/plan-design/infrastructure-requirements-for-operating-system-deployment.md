---
title: Требования к инфраструктуре развертывания операционной системы
titleSuffix: Configuration Manager
description: Сведения о внешних зависимостях, зависимостях продуктов и требованиях для развертывания ОС в Configuration Manager
ms.date: 07/05/2019
ms.prod: configuration-manager
ms.technology: configmgr-osd
ms.topic: conceptual
ms.assetid: 1dc74219-7ff5-4e3b-b4f6-5aad663bb75b
author: aczechowski
ms.author: aaroncz
manager: dougeby
ms.openlocfilehash: f34c803cb2b43a2c69cee4c16f5029474e318eb2
ms.sourcegitcommit: bbf820c35414bf2cba356f30fe047c1a34c5384d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/21/2020
ms.locfileid: "81709342"
---
# <a name="infrastructure-requirements-for-os-deployment-in-configuration-manager"></a>Требования к инфраструктуре для развертывания ОС в Configuration Manager

*Область применения: Configuration Manager (Current Branch)*

Развертывание ОС в Configuration Manager имеет внешние зависимости и зависимости в пределах продукта. В этой статье описывается подготовка инфраструктуры для развертывания ОС.  

##  <a name="dependencies-external-to-configuration-manager"></a><a name="BKMK_ExternalDependencies"></a> Внешние зависимости Configuration Manager  

В этом разделе приводятся сведения о внешних средствах, наборах установки и версиях ОС, которые необходимы для развертывания операционных систем в Configuration Manager.  

### <a name="windows-adk-for-windows-10"></a>Windows ADK для Windows 10  

Комплект средств для развертывания и оценки Windows (Windows ADK) — это набор средств и документации для настройки и развертывания Windows. Configuration Manager использует Windows ADK для автоматизации действий, таких как установка Windows, запись образов и миграция профилей и данных пользователей.  

Дополнительные сведения см. в следующих статьях:  

- [Сценарии Windows ADK для Windows 10 для ИТ-специалистов](https://docs.microsoft.com/windows/deployment/windows-adk-scenarios-for-it-pros)  

- [Скачивание Windows ADK для Windows 10](https://docs.microsoft.com/windows-hardware/get-started/adk-install)  

    > [!IMPORTANT]
    > Обязательно загрузите **Windows ADK для Windows 10** и **надстройку Windows PE для ADK**.

- [Поддержка Windows 10](../../core/plan-design/configs/support-for-windows-10.md)  

#### <a name="site-systems"></a>Системы сайта
Windows ADK является необходимым компонентом для следующих серверов систем сайта:

- сервер сайта верхнего уровня в иерархии;  

- сервер каждого первичного сайта в иерархии;  

- каждый экземпляр поставщика SMS.  


> [!NOTE]  
> Вручную установите Windows ADK на каждом сервере сайта, прежде чем устанавливать сайт Configuration Manager.  

#### <a name="windows-adk-features"></a>Компоненты Windows ADK
Установите следующие компоненты Windows ADK:  

-   Средство миграции пользовательской среды (USMT)  

    > [!Note]  
    > USMT не требуется для поставщика SMS.

-   Средства развертывания Windows  

-   Среда предварительной установки Windows (Windows PE)  

    > [!Important]  
    > Начиная с Windows 10 версии 1809 для установки среды Windows PE используется отдельный установщик. Другие функции не отличаются.<!--SCCMDocs-pr issue 2908-->  

Список версий Windows 10 ADK, которые можно использовать с разными версиями Configuration Manager, см. в разделе [Поддержка для Windows 10](../../core/plan-design/configs/support-for-windows-10.md#windows-10-adk).


### <a name="user-state-migration-tool-usmt"></a>Средство миграции пользовательской среды (USMT)  

Configuration Manager использует пакет USMT, который содержит исходные файлы USMT 10 для записи и восстановления пользовательского состояния в рамках развертывания ОС. При установке Configuration Manager на сайте верхнего уровня автоматически создается пакет USMT. USMT 10 записывает данные о пользовательской среде из Windows 7, Windows 8, Windows 8.1 и Windows 10.  

Дополнительные сведения см. в следующих статьях:  

- [Распространенные сценарии миграции для USMT 10](https://docs.microsoft.com/windows/deployment/usmt/usmt-common-migration-scenarios)  

- [Управление пользовательской средой](../get-started/manage-user-state.md)  


### <a name="windows-pe"></a>Windows PE  

Windows PE используется загрузочными образами для запуска компьютера. Это версия Windows с ограниченными функциями, которая используется во время предустановки и развертывания Windows. Ниже перечислены поддерживаемые версии Windows ADK для Configuration Manager Current Branch.  

#### <a name="windows-adk-version"></a>Версия Windows ADK  
Windows ADK для Windows 10. Дополнительные сведения см. в разделе [Поддержка для Windows 10](../../core/plan-design/configs/support-for-windows-10.md#windows-10-adk).

#### <a name="windows-pe-versions-for-boot-images-customizable-from-the-configuration-manager-console"></a>Версии среды предустановки Windows для загрузочных образов с возможностью настройки в консоли Configuration Manager  
Windows PE 10  

#### <a name="supported-windows-pe-versions-for-boot-images-not-customizable-from-the-configuration-manager-console"></a>Поддерживаемые версии среды предустановки Windows для загрузочных образов без возможности настройки в консоли Configuration Manager  
Среда предустановки Windows 3.1<sup>1</sup> и среда предустановки Windows 5  

<sup>1</sup> Образ загрузки можно добавить в Configuration Manager, только если он был создан на основе среды предустановки Windows 3.1. Установите дополнительный компонент Windows AIK для Windows 7 с пакетом обновления 1 (SP1), чтобы обновить Windows AIK для Windows 7 (на основе среды предустановки Windows 3) с помощью дополнительного компонента Windows AIK для Windows 7 с пакетом обновления 1 (SP1) (на основе среды предустановки Windows 3.1). Скачайте дополнительный компонент Windows AIK для Windows 7 с пакетом обновления 1 (SP1) из [Центра загрузки Майкрософт](https://www.microsoft.com/download/details.aspx?id=5188).  

Например, если используется Configuration Manager, загрузочные образы из Windows ADK для Windows 10 (на основе среды предустановки Windows 10) можно настраивать в консоли Configuration Manager. Однако несмотря на то, что загрузочные образы на основе Windows PE 5 поддерживаются, их необходимо настраивать с другого компьютера и использовать версию DISM, установленную вместе с Windows ADK для Windows 8. После этого добавьте загрузочный образ в консоль Configuration Manager. Дополнительные сведения о настройке образа загрузки (добавлении дополнительных компонентов и драйверов), включении поддержки команд для образа загрузки, добавлении образа загрузки в консоль Configuration Manager и обновлении точек распространения с учетом образа загрузки см. в разделе [Настройка загрузочных образов](../get-started/customize-boot-images.md). Дополнительные сведения об образах загрузки см. в разделе [Управление загрузочными образами](../get-started/manage-boot-images.md).  


### <a name="windows-server-update-services-wsus"></a>Службы Windows Server Update Services (WSUS)  

Для точки обновления программного обеспечения требуется служба WSUS, чтобы установить обновления программного обеспечения во время развертывания ОС. Дополнительные сведения см. в разделе [Установка и настройка точки обновления программного обеспечения](../../sum/get-started/install-a-software-update-point.md).


### <a name="internet-information-services-iis-on-the-site-system-servers"></a>Службы IIS на серверах систем сайта  

Службы IIS необходимы для точки распространения, точки миграции состояния и точки управления. Дополнительные сведения см. в разделе [Необходимые компоненты для сайта и системы сайта](../../core/plan-design/configs/site-and-site-system-prerequisites.md).  


### <a name="windows-deployment-services-wds"></a>Службы развертывания Windows (WDS)  

В версиях 1802 и ранее для PXE-развертываний необходимы службы WDS. Начиная с версии 1806 можно включить PXE в точке распространения без WDS. Дополнительные сведения см. в разделе [Службы развертывания Windows](#BKMK_WDS) в этой статье. 


### <a name="dynamic-host-configuration-protocol-dhcp"></a>Протокол DHCP  

DHCP необходим для PXE-развертываний. Необходимо иметь работающий DHCP-сервер с активным узлом для развертывания операционных систем с помощью протокола PXE. Дополнительные сведения о PXE-развертываниях см. в разделе [Использование PXE для развертывания Windows по сети](../deploy-use/use-pxe-to-deploy-windows-over-the-network.md).  


### <a name="supported-operating-systems-and-hard-disk-configurations"></a>Поддерживаемые операционные системы и конфигурации жесткого диска  

Дополнительные сведения о версиях ОС и конфигурациях жесткого диска, поддерживаемых Configuration Manager при развертывании операционных систем, см. в разделах [Поддерживаемые операционные системы](#BKMK_SupportedOS) и [Поддерживаемые конфигурации диска](#BKMK_SupportedDiskConfig).  


### <a name="windows-device-drivers"></a>Драйверы устройств Windows  

Драйверы устройств Windows можно использовать при установке ОС на конечном компьютере. Они также используются при выполнении Windows PE в образе загрузки. Дополнительные сведения см. в разделе [Управление драйверами](../get-started/manage-drivers.md).  



##  <a name="configuration-manager-dependencies"></a><a name="BKMK_InternalDependencies"></a> Зависимости Configuration Manager  

В этом разделе приведены сведения о требованиях Configuration Manager к развертыванию ОС.  


### <a name="os-image"></a>Образ ОС  

Образы ОС в Configuration Manager хранятся в формате Windows Imaging (WIM). Они представляют собой сжатый набор ссылочных файлов и папок. Эти образы необходимы для успешной установки и настройки ОС на компьютере. Дополнительные сведения см. в разделе [Управление образами операционных систем](../get-started/manage-operating-system-images.md).  


### <a name="driver-catalog"></a>Каталог драйверов  

Чтобы выполнить развертывание драйвера устройств, необходимо импортировать драйвер, включить его и сделать доступным в точке распространения, которая доступна для клиента Configuration Manager. Дополнительные сведения о каталоге драйверов см. в разделе [Управление драйверами](../get-started/manage-drivers.md).  


### <a name="management-point"></a>Точка управления  

Точки управления передают данные между клиентами и сайтом Configuration Manager. Клиент использует точку управления для выполнения последовательности задач и завершения развертывания ОС. Дополнительные сведения о последовательностях задач см. в разделе [Вопросы планирования для автоматизации задач](planning-considerations-for-automating-tasks.md).  


### <a name="distribution-point"></a>Точка распространения  

Точки распространения используются в большинстве развертываний для хранения данных, используемых при развертывании ОС, таких как образы или пакеты драйверов. Последовательности задач, как правило, получают данные, необходимые для развертывания ОС, из точки распространения. Дополнительные сведения об установке точек распространения и управлении содержимым см. в разделе [Управление содержимым и инфраструктурой содержимого](../../core/servers/deploy/configure/manage-content-and-content-infrastructure.md).  


### <a name="pxe-enabled-distribution-point"></a>Точка распространения с поддержкой PXE  

Для выполнения развертываний, запускаемых по сети (PXE), необходимо настроить точку распространения так, чтобы она принимала PXE-запросы от клиентов. Дополнительные сведения см. в разделе [Настройка точки распространения](../../core/servers/deploy/configure/install-and-configure-distribution-points.md#bkmk_config-pxe).


### <a name="multicast-enabled-distribution-point"></a>Точка распространения с поддержкой многоадресной рассылки  

Чтобы оптимизировать развертывание ОС, необходимо настроить для точки распространения поддержку многоадресной рассылки. Дополнительные сведения см. в разделе [Настройка точки распространения](../../core/servers/deploy/configure/install-and-configure-distribution-points.md#bkmk_config-multicast).   


### <a name="state-migration-point"></a>точка миграции состояния,  

При сборе и восстановлении данных пользовательской среды для параллельных развертываний и развертываний обновлений необходимо настроить точки миграции состояния для хранения данных пользовательской среды на другом компьютере.  

Дополнительные сведения о настройке точек миграции состояния см. в разделе [Точка миграции состояния](../get-started/prepare-site-system-roles-for-operating-system-deployments.md#BKMK_StateMigrationPoints).  

Сведения о сборе и восстановлении данных о пользовательской среде см. в статье [Управление пользовательской средой](../get-started/manage-user-state.md).  


### <a name="reporting-services-point"></a>Точка служб отчетов  

Для использования отчетов Configuration Manager при развертывании ОС необходимо установить и настроить точку формирования отчетов. Дополнительные сведения см. в разделе [Общие сведения об отчетах](../../core/servers/manage/introduction-to-reporting.md).  


### <a name="security-permissions-for-os-deployments"></a>Разрешения безопасности для развертываний ОС  

Роль безопасности **менеджер развертывания операционных систем** — это встроенная роль, которую нельзя изменить. Тем не менее, эту роль можно скопировать, внести изменения, а затем сохранить ее как новую настраиваемую роль безопасности. Ниже приведены некоторые разрешения, которые применяются непосредственно к развертываниям ОС.  

- **Пакет загрузочного образа**: создание, удаление, изменение, изменить папку, переместить объект, чтение, настройка области безопасности.  

- **Драйверы устройств**: создание, удаление, изменение, изменить папку, изменить отчет, переместить объект, чтение, выполнение отчета.  

- **Пакет драйвера**: создание, удаление, изменение, изменить папку, переместить объект, чтение, настройка области безопасности.  

- **Образ операционной системы**: создание, удаление, изменение, изменить папку, переместить объект, чтение, настройка области безопасности.  

- **Пакет обновления операционной системы**: создание, удаление, изменение, изменить папку, переместить объект, чтение, настройка области безопасности.  

- **Пакет последовательности задач**: создание, создать носитель с файлом последовательности задач, удаление, изменение, изменить папку, изменить отчет, переместить объект, чтение, выполнить отчет, настройка области безопасности.  

Дополнительные сведения см. в разделе [Создание настраиваемых ролей безопасности](../../core/servers/deploy/configure/configure-role-based-administration.md#BKMK_CreateSecRole).  


### <a name="security-scopes-for-os-deployments"></a>Области безопасности для развертываний ОС  

Области безопасности служат для предоставления администраторам доступа к защищаемым объектам, которые используются при развертывании ОС, таким как образы ОС и образы загрузки, пакеты драйверов и пакеты последовательностей задач. Дополнительные сведения см. в разделе [Области безопасности](../../core/understand/fundamentals-of-role-based-administration.md#bkmk_PlanScope).  



##  <a name="windows-deployment-services"></a><a name="BKMK_WDS"></a> Службы развертывания Windows  

В версиях 1802 и ранее службы развертывания Windows (WDS) необходимо устанавливать на том же сервере, что и точки распространения, настроенные для поддержки PXE или многоадресной рассылки. Службы WDS входят в состав серверной ОС. В PXE-развертываниях WDS — это служба, которая выполняет загрузку PXE. После установки точки распространения и включения на ней поддержки PXE Configuration Manager устанавливает поставщик на сервер WDS, который использует функции загрузки PXE службы WDS.  

Начиная с версии 1806 можно включить PXE в точке распространения без WDS. Дополнительные сведения см. в описании параметра **Включить ответчик PXE без служб развертывания Windows** в статье [Установка и настройка точек распространения](../../core/servers/deploy/configure/install-and-configure-distribution-points.md#bkmk_config-pxe).


> [!NOTE]  
>  Если сервер требует перезагрузки, может произойти сбой установки служб WDS. 


### <a name="wds-requirements"></a>Требования WDS  

-   Для установки WDS на сервере администратор должен быть членом локальной группы администраторов.  

-   Сервер WDS должен входить в домен Active Directory или являться контроллером домена Active Directory. Все конфигурации домена и леса Windows поддерживают WDS.  

-   Если поставщик установлен на удаленном сервере, WDS необходимо установить на сервере сайта и на сервере удаленного поставщика.  


###  <a name="considerations-when-you-have-wds-and-dhcp-on-the-same-server"></a><a name="BKMK_WDSandDHCP"></a> Рекомендации при наличии WDS и DHCP на одном сервере  

Если точку распространения планируется разместить на DHCP-сервере, следует учесть следующие аспекты:  

-   DHCP-сервер должен работать и обладать активной областью. WDS использует протокол PXE, для которого требуется DHCP-сервер.  

-   Для запуска WDS требуется DNS-сервер.  

-   На сервере WDS необходимо открыть следующие UDP-порты:  

    -   порт 67 (DHCP);  

    -   порт 69 (протокол TFTP);  

    -   порт 4011 (PXE).  

    > [!NOTE]  
    >  Если на сервере требуется авторизация DHCP, необходимо открыть на этом сервере порт клиента DHCP с номером 68.  

-   Для DHCP и WDS требуется номер порта 67. При размещении WDS и DHCP на одном сервере можно переместить DHCP или точку распространения, настроенную для PXE, на отдельный сервер. Кроме того, можно настроить для сервера WDS прослушивание в другом порте с помощью следующей процедуры.  

#### <a name="to-configure-the-wds-server-to-listen-on-a-different-port"></a>Настройка прослушивания в другом порте для сервера WDS  

1.  Измените следующий раздел реестра:  

     `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WDSServer\Providers\WDSPXE`  

2.  Присвойте значению реестра **UseDHCPPorts** значение **0**.  

3.  Чтобы изменения вступили в силу, выполните следующую команду на сервере:  

     `WDSUTIL /Set-Server /UseDHCPPorts:No /DHCPOption60:Yes`  

> [!NOTE]
> В версии 1810 и более ранних не поддерживается использование отвечающего устройства PXE без WDS на серверах, на которых также работает DHCP-сервер.
>
> Начиная с версии 1902, при включении отвечающего устройства PXE в точке распространения без службы развертывания Windows оно может находиться на одном сервере со службой DHCP. См. подробнее о [настройке по меньшей мере одной точки распространения для приема PXE-запросов](../deploy-use/use-pxe-to-deploy-windows-over-the-network.md#BKMK_Configure).


##  <a name="supported-operating-systems"></a><a name="BKMK_SupportedOS"></a> Поддерживаемые операционные системы  

Все операционные системы Windows, указанные как поддерживаемые клиенты в разделе [Поддерживаемые операционные системы для клиентов и устройств](../../core/plan-design/configs/supported-operating-systems-for-clients-and-devices.md), поддерживаются при развертывании ОС.  



##  <a name="supported-disk-configurations"></a><a name="BKMK_SupportedDiskConfig"></a> Поддерживаемые конфигурации диска  

В приведенной ниже таблице представлены сочетания конфигураций жестких дисков на компьютере-образце и конечном компьютере, поддерживаемые при развертывании ОС с помощью Configuration Manager.  

|Конфигурация жесткого диска эталонного компьютера|Конфигурация жесткого диска конечного компьютера|  
|------------------------------------------------|--------------------------------------------------|  
|Базовый диск|Базовый диск|  
|Простой том динамического диска|Простой том динамического диска|  

Configuration Manager поддерживает создание образов ОС только с компьютеров, настроенных с использованием простых томов. Не поддерживаются следующие конфигурации жесткого диска:  

-   Составные тома.  

-   Чередующиеся тома (RAID 0).  

-   Зеркальные тома (RAID 1).  

-   Тома с контролем четности (RAID 5).  

В таблице ниже перечислены дополнительные конфигурации жестких дисков на компьютере-образце и конечном компьютере, не поддерживаемые Configuration Manager при развертывании ОС.  

|Конфигурация жесткого диска эталонного компьютера|Конфигурация жесткого диска конечного компьютера|  
|------------------------------------------------|--------------------------------------------------|  
|Базовый диск|Динамический диск|  



## <a name="next-steps"></a>Дальнейшие шаги

- [Подготовка ролей системы сайта к развертыванию ОС](../get-started/prepare-site-system-roles-for-operating-system-deployments.md)
- [Подготовка к развертыванию ОС](../get-started/prepare-for-operating-system-deployment.md)
