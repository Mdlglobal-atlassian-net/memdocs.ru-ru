---
title: Отладка последовательности задач
titleSuffix: Configuration Manager
description: Для устранения неполадок с последовательностью задач используйте отладчик последовательности задач.
ms.date: 11/29/2019
ms.prod: configuration-manager
ms.technology: configmgr-osd
ms.topic: conceptual
ms.assetid: 4b60b0e1-ffa4-4fd5-864e-70a0546c8b3b
author: aczechowski
ms.author: aaroncz
manager: dougeby
ms.openlocfilehash: 66f460b7ba5c870a9ee81d10835ceb9f660cba89
ms.sourcegitcommit: bbf820c35414bf2cba356f30fe047c1a34c5384d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/21/2020
ms.locfileid: "81690612"
---
# <a name="debug-a-task-sequence"></a>Отладка последовательности задач

*Область применения: Configuration Manager (Current Branch)*

<!--3612274-->

Начиная с версии 1906 используется новое средство устранения неполадок — отладчик последовательности задач. Развертывание последовательности задач проводится в режиме отладки на небольшую коллекцию. Это позволяет контролируемым образом использовать пошаговое выполнение последовательности задач для облегчения устранения неполадок и исследования. В настоящее время отладчик работает на том же устройстве, что и подсистема последовательности задач, и не является удаленным.

> [!Note]  
> В этой версии Configuration Manager отладчик последовательности задач является функцией предварительного выпуска. Сведения о ее включении см. в разделе [Функции предварительной версии](../../core/servers/manage/pre-release-features.md).  


## <a name="prerequisites"></a>Предварительные условия

- Обновление клиента Configuration Manager на целевом устройстве

- Выполните вход на целевом устройстве как пользователь локальной группы **Администраторы**. Отладчик запускается только для администраторов.

- Обновите образ загрузки, связанный с последовательностью задач, чтобы гарантировать, что он включает последнюю версию клиента.


## <a name="start-the-tool"></a>Запуск отладчика

1. В консоли Configuration Manager, в рабочей области **Библиотека программного обеспечения**, разверните узел **Операционные системы** и выберите элемент **Последовательности задач**.

1. Выберите последовательность задач. В группе развертывания на ленте выберите **Отладка**.

    > [!Tip]  
    > Вы также можно задать для **TSDebugMode** значение `TRUE` для коллекции или объекта-компьютера, где развертывается последовательность задач. Любое устройство с таким значением этой переменной поместит все последовательности задач, развернутые на него, в режим отладки.

1. Создайте отладочное развертывание. Параметры развертывания такие же, как при обычном развертывании последовательности задач. Дополнительные сведения см. в статье [Deploy a task sequence](deploy-a-task-sequence.md#process).

    > [!Note]  
    > Для отладочного развертывания можно выбрать только небольшую коллекцию. Отображаются только коллекции устройств с 10 членами или меньше.

Начиная с версии 1910, используйте новую переменную последовательности задач **TSDebugOnError** для автоматического запуска отладчика, когда последовательность задач возвращает ошибку.<!-- 5012536 --> Дополнительные сведения см. в разделе [Переменные последовательности задач — TSDebugOnError](../understand/task-sequence-variables.md#TSDebugOnError).

## <a name="use-the-tool"></a>Использование средства

При выполнении последовательности задач на устройстве открывается окно отладчика последовательности задач, как на следующем снимке экрана:

![Снимок экрана отладчика последовательности задач](media/3612274-tsdebug.png)

Отладчик включает в себя следующие элементы управления:

- **Шаг**. Из *текущей* позиции выполните только следующий шаг в последовательности задач.  

    > [!Note]  
    > Когда последовательность задач находится в режиме отладки, в случае, если шаг возвращает неустранимую ошибку, последовательность задач не завершается сбоем, как это происходит обычно. Такое поведение позволяет повторить шаг после внесения внешнего изменения.

- **Run**(Запуск): из *текущей* позиции будет выполнена последовательность задач до конца или следующей точки *останова*, если шаг будет выполнен со сбоем. Прежде чем использовать это действие, обязательно установите все точки останова с помощью действия **Задать точку останова**.

- **Задать текущий шаг**. Выберите шаг в отладчике, а затем **Задать текущий шаг**. Это действие перемещает *текущий* указатель на этот шаг. Это действие позволяет пропустить шаги или переместиться в обратном направлении.  

    > [!Warning]  
    > Отладчик не рассматривает тип шага при изменении текущей позиции в последовательности. Некоторые шаги могут задавать переменные последовательности задач, необходимые для оценки условий на последующих шагах. При выполнении в другом порядке некоторые шаги могут завершиться сбоем или причинить значительный ущерб устройству. Используйте этот параметр на свой страх и риск.  

- **Задать точку останова**. Выберите шаг в отладчике, а затем **Задать точку останова**. Это действие добавляет точку *останова* в отладчике. Когда вы **запускаете** последовательность задач, она останавливается *на останове*.  

    - Прежде чем использовать действие **Выполнить**, задайте точки останова.

    - Начиная с версии 1910, если в отладчике создать точку останова, а затем последовательность задач перезапустит компьютер, отладчик сохранит точки останова после перезапуска.<!-- 5012509 -->

    - В версии 1906 точки останова не сохраняются после перезагрузки компьютера, например при выполнении команды [Перезагрузить компьютер](../understand/task-sequence-steps.md#BKMK_RestartComputer). Например, если вы запускаете отладчик из центра программного обеспечения для последовательности задач создания образов, не устанавливайте точки останова на этапе Windows PE. Когда компьютер перезапускается в Windows PE, отладчик приостанавливает последовательность задач, чтобы вы могли задать точки останова.

- **Очистить все точки останова**: удаляет все точки останова.

- **Файл журнала**: открывает текущий файл журнала последовательности задач, **Smsts. log** с помощью [CMTrace](../../core/support/cmtrace.md). Записи журнала отображаются, пока подсистема последовательности задач находится в режиме "Ожидание отладчика".

- **Командная строка**: в Windows PE открывает командную строку.

- **Отмена**: закрывает отладчик и останавливает последовательность задач.

- **Выход**. отсоединяет и закрывает отладчик, но последовательность задач продолжит выполняться в обычном режиме.

В окне **переменные последовательности задач** отображаются текущие значения для всех переменных в среде последовательности задач. Дополнительные сведения см. в описании [переменных последовательности задач](../understand/task-sequence-variables.md). Если вы используете шаг [Задать переменную последовательности задач](../understand/task-sequence-steps.md#BKMK_SetTaskSequenceVariable) с параметром **Не отображать это значение**, отладчик не отображает значение переменной. Изменить значения переменных в отладчике нельзя.

> [!Note]
> Некоторые переменные последовательности задач предназначены только для внутреннего использования и не указаны в справочной документации.

Отладчик последовательности задач продолжит работу после выполнения шага [Перезагрузить компьютер](../understand/task-sequence-steps.md#BKMK_RestartComputer), но все точки останова нужно будет создать повторно. Хотя последовательность задач может этого не требовать, так как отладчик требует взаимодействия с пользователем, чтобы продолжить, нужно выполнить вход в Windows. Если вы не войдете в систему в течение одного часа для продолжения отладки, последовательность задач завершится ошибкой.

Кроме того, она выполняет по шагам дочернюю последовательность задач с шагом [Выполнить последовательность задач](../understand/task-sequence-steps.md#child-task-sequence). В окне отладчика отображаются шаги дочерней последовательности задач, а также главная последовательность задач.


## <a name="known-issues"></a>Известные проблемы

Если и обычное, и отладочное развертывание выполняются на одном устройстве в несколько развертываний, отладчик последовательности задач может не запуститься.


## <a name="see-also"></a>См. также

- [Сведения о шагах последовательности задач](../understand/task-sequence-steps.md)
- [Переменные последовательности задач](../understand/task-sequence-variables.md)
- [Создание переменных последовательности задач](../understand/using-task-sequence-variables.md)
- [Развертывание последовательности задач](deploy-a-task-sequence.md)
