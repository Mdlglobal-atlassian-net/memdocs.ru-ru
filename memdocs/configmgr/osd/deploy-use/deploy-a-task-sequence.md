---
title: Развертывание последовательности задач
titleSuffix: Configuration Manager
description: Информация о развертывании последовательности задач на компьютерах в коллекции.
ms.date: 11/29/2019
ms.prod: configuration-manager
ms.technology: configmgr-osd
ms.topic: conceptual
ms.assetid: b2abcdb0-72e0-4c70-a4b8-7827480ba5b2
author: aczechowski
ms.author: aaroncz
manager: dougeby
ms.openlocfilehash: c2347275ffdc194e73cf792d6f83ffa75732f8c4
ms.sourcegitcommit: bbf820c35414bf2cba356f30fe047c1a34c5384d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/21/2020
ms.locfileid: "81691132"
---
# <a name="deploy-a-task-sequence"></a>Развертывание последовательности задач

*Область применения: Configuration Manager (Current Branch)*

Создав последовательность задач и распространив указанное в ней содержимое, вы можете начать ее развертывание в коллекцию устройств. Это действие позволяет выполнить последовательность задач на устройстве. Развернутая последовательность задач может выполняться автоматически или по команде пользователя на устройстве.

> [!WARNING]  
> Вы можете управлять поведением развертываний последовательности задач с высоким риском. Развертывание с высоким риском — это развертывание, которое устанавливается автоматически и потенциально может привести к нежелательным результатам. Например, последовательность задач с целью **Обязательно**, которая развертывает операционную систему, считается развертыванием с высоким риском. Дополнительные сведения см. в разделе [Параметры для управления развертываниями с высоким риском](../../core/servers/manage/settings-to-manage-high-risk-deployments.md).  

## <a name="process"></a>Процесс

Для развертывания последовательности задач на компьютерах в коллекции используйте следующую процедуру.  

> [!NOTE]  
> Сообщения о состоянии развертывания последовательности задач отображаются в окне сообщений на первичном сайте, но не отображаются на сайте центра администрирования.  

1. В консоли Configuration Manager перейдите к рабочей области **Библиотека программного обеспечения**, разверните узел **Операционные системы** и выберите **Последовательности задач**.  

2. В списке **Последовательность задач** выберите последовательность задач, которую требуется развернуть.  

3. На вкладке **Главная** в ленте в группе **Развертывание** выберите **Развернуть**.  

    > [!NOTE]  
    > Если кнопка **Развернуть** недоступна, значит последовательность задач содержит недействительную ссылку. Исправьте ссылку и попробуйте развернуть последовательность задач еще раз.  

4. На странице **Общие** укажите перечисленные ниже сведения.  

    - **Последовательность задач**. Укажите последовательность задач, которую нужно развернуть. По умолчанию в этом поле отображается выбранная последовательность задач.  

    - **Коллекция**. Выберите коллекцию с компьютерами, на которых нужно выполнить последовательность задач.  

        Не следует развертывать последовательность задач, которая устанавливает операционную систему, в неподходящих коллекциях, например в коллекции всех серверов центра обработки данных. Убедитесь, что выбранная коллекция содержит только те компьютеры, на которых должна выполняться последовательность задач.  

        Дополнительные сведения на эту тему см. в статье [Управление развертываниями с высоким риском](#bkmk_high-risk).

    - **Использовать группы точек распространения по умолчанию, связанные с этой коллекцией**. Содержимое последовательности задач сохраняется в используемой по умолчанию группе точек распространения коллекции. Этот параметр недоступен, если выбранная коллекция не была связана с группой точек распространения.  

    - **Автоматически распространять содержимое для зависимостей**. Если любое содержимое, на которое указывает ссылка, имеет зависимости, сайт также отправляет зависимое содержимое в точки распространения.  

    - **Предварительно скачивать содержимое для этой последовательности задач**: Дополнительные сведения см. в разделе [Настройка предварительного кэширования содержимого](configure-precache-content.md).  

    - **Выбор шаблона развертывания**. Сохраните и укажите шаблон развертывания для последовательности задач.<!--1357391-->  

        > [!IMPORTANT]  
        > Некоторые элементы в шаблоне не сохраняются.<!--510610--> Убедитесь, что при запуске мастера развертывания применяются следующие элементы:  
        >
        > - Установка программного обеспечения
        > - Планирование
        > - Предварительное скачивание содержимого

    - **Комментарии (необязательно)** . Укажите дополнительные сведения, описывающие это развертывание последовательности задач.  

5. На странице **Параметры развертывания** укажите следующие сведения:  

    - **Назначение**. В раскрывающемся списке выберите одно из следующих значений.  

        - **Доступно**. Пользователь увидит последовательность задач в центре программного обеспечения и сможет установить ее по запросу.  

        - **Обязательное**. Configuration Manager автоматически запускает последовательность задач по настроенному расписанию. Если последовательность задач не скрыта, пользователь по-прежнему может отслеживать ее состояние развертывания. Он также может установить последовательность задач с помощью центра программного обеспечения до наступления крайнего срока.  

        > [!NOTE]
        > Если несколько пользователей вошли в устройство, пакет и развертывания последовательностей задач могут не отображаться в центре программного обеспечения.  

    - **Make available to the following** (Сделать доступной для). Выберите, для кого будет доступна эта последовательность задач:  

        - только клиенты Configuration Manager;  
        - Клиенты Configuration Manager, носители и PXE  
        - Только носители и PXE  
        - Только носители и PXE (скрытые)  

        > [!IMPORTANT]  
        > Используйте для автоматизированного развертывания последовательностей задач вариант **Только носители и PXE (скрытые)** . Чтобы компьютер автоматически загружался в режиме развертывания без вмешательства пользователя, выберите параметр **Allow unattended operating system deployment** (Разрешить автоматическое развертывание операционной системы) и задайте переменную **SMSTSPreferredAdvertID** в составе носителя. Дополнительные сведения о переменных последовательности задач см. [здесь](../understand/task-sequence-variables.md#SMSTSPreferredAdvertID).  

    - **Отправлять wake-up пакеты**. Если развертывание является **обязательным** и вы выбрали этот параметр, то Configuration Manager отправит на компьютеры wake-up пакеты перед запуском развертывания на клиенте. Эти пакеты выводят компьютеры из спящего режима при наступлении крайнего срока установки. Для использования этого параметра необходимо включить поддержку пробуждения по локальной сети на компьютерах и в сетях. Дополнительные сведения см. в разделе [Планирование пробуждения клиентов](../../core/clients/deploy/plan/plan-wake-up-clients.md).  

    - **Все клиенты должны использовать лимитное подключение к Интернету для скачивания содержимого после наступления крайнего срока установки. Это может повлечь дополнительные затраты**. Эта опция доступна только для **обязательных** развертываний. Если пользовательская последовательность задач устанавливает приложение, но не развертывает операционную систему, вы можете выбрать, разрешено ли клиентам загружать содержимое по истечении крайнего срока установки через лимитное подключение к Интернету. Иногда поставщики услуг Интернета взимают плату за объем передаваемых данных, если вы используете лимитное подключение к Интернету.  

        > [!NOTE]  
        > Хотя лимитное подключение к Интернету может нормально работать для последовательностей задач, не развертывающих операционные системы, такое использование не поддерживается.  

6. На странице **Расписание** укажите следующие сведения:  

    > [!IMPORTANT]  
    > При запуске клиента Windows PE через PXE или с загрузочного носителя клиент не оценивает расписания развертывания. Эти расписания определяют время начала, время завершения и крайний срок. Настраивайте расписания только в развертываниях на клиентах, начинающихся с полной операционной системы Windows. Рассмотрите возможность использования других способов, таких как периоды обслуживания, для управления активными последовательностями задач, разворачиваемыми на клиентах, которые начинают с Windows PE.  

    - **Планирование условий доступности этого развертывания**. Укажите дату и время, когда последовательность задач будет доступна для выполнения на конечном компьютере. Если вы выберете вариант **UTC**, последовательность задач станет доступна для нескольких компьютеров одновременно. В противном случае развертывание предоставляется в разное время в соответствии с местным временем на каждом компьютере.  

        Если время начала меньше, чем требуемое время, клиент загружает содержимое последовательности задач в указанное время начала.  

    - **Срок окончания действия этого развертывания**. Укажите дату и время окончания срока действия последовательности задач на конечном компьютере. Если вы выберете вариант **UTC**, выполнение последовательности задач завершится на всех конечных компьютерах одновременно. В противном случае развертывание завершается в разное время в соответствии с местным временем на каждом компьютере.  

    - **Расписание назначений**. Для **обязательных** развертываний укажите, когда клиент выполняет последовательность задач. Можно добавить несколько расписаний. В расписании назначений можно настроить одну из следующих конфигураций:  

        - конкретные дата и время;  
        - ежемесячно, еженедельно или с пользовательским интервалом;  
        - как можно скорее;  
        - события входа в систему и выхода из системы.  

        > [!NOTE]  
        > Если для обязательного развертывания вы назначите время начала раньше, чем дата и время доступности соответствующей последовательности задач, клиент Configuration Manager загрузит содержимое в назначенное время начала. В этой ситуации он игнорирует то, что последовательность задач будет доступна только в более позднее время.<!--SCCMDocs issue 777-->  

    - **Rerun behavior** (Поведение повторного запуска). Укажите время повторного выполнения последовательности задач. Выберите один из следующих параметров:  

        - **Never rerun deployed program** (Никогда не запускать повторно развернутую программу). Последовательность задач не выполняется повторно на клиенте, если она была ранее выполнена на нем. Последовательность задач не выполняется повторно, если она была изначально завершена неудачно или файлы последовательности были изменены.  

        - **Всегда повторять запуск программы**. Последовательность задач всегда выполняется повторно на стороне клиента в назначенное время, даже если эта последовательность задач уже была успешно выполнена. Этот параметр полезен при использовании повторяющихся развертываний, когда происходит плановое обновление последовательности задач.  

            > [!IMPORTANT]  
            > Этот параметр установлен по умолчанию. Но он не действует, пока вы не назначите обязательное развертывание. Пользователь всегда может повторно запустить доступные развертывания.  

        - **Повторить запуск, если предыдущая попытка не удалась**. Последовательность задач выполняется повторно в назначенное время, только если ее предыдущее выполнение завершилось неудачно. Этот вариант полезен для обязательных развертываний. Он позволяет автоматически повторять попытки выполнения в соответствии с расписанием назначений, если последняя попытка оказалась неудачной.  

        - **Повторить запуск, если предыдущая попытка была успешной**. Последовательность задач выполняется повторно только в случае успешной предыдущей попытки запуска на клиенте. Этот параметр полезен при использовании повторяющихся развертываний, когда происходит плановое обновление последовательности задач, и для каждого последующего обновления требуется успешная установка предыдущего обновления.  

        > [!NOTE]  
        > Пользователь может перезапустить развертывание доступной последовательности задач. Перед развертыванием доступной последовательности задач в рабочей среде обязательно проверьте, что происходит при нескольких запусках последовательности задач.  

7. На странице **Взаимодействие с пользователем** укажите перечисленные ниже сведения.  

    - **Allow user to run the program independently of assignments** (Разрешить пользователю запускать программу независимо от назначения). Укажите, может ли пользователь запускать требуемое развертывание вне расписания установки. Этот вариант всегда включен для доступных развертываний.  

    - **Показать ход выполнения последовательности задач**. Укажите, должен ли ход выполнения последовательности задач отображаться в клиенте Configuration Manager.  

    - **Установка программного обеспечения**. Укажите, разрешено ли пользователю устанавливать программное обеспечение вне заданных периодов обслуживания после назначенного времени.  

    - **Перезагрузка системы (если это необходимо для завершения установки)** . Укажите, разрешено ли пользователю перезагружать компьютер после установки программного обеспечения вне заданного периода обслуживания по прошествии назначенного времени.  

    - **Обработка фильтра записи для устройств Windows Embedded**. Этот параметр управляет режимом установки на устройствах Windows Embedded, включенных с помощью фильтра записи. Выберите этот параметр, чтобы фиксировать изменения по наступлении крайнего срока установки или в течение периода обслуживания. При выборе этого параметра требуется перезагрузка, и изменения сохраняются на устройстве. В противном случае приложение устанавливается во временное наложение и фиксируется позднее. При развертывании последовательности задач на устройстве Windows Embedded убедитесь, что устройство входит в коллекцию, для которой настроен период обслуживания.  

    - **Разрешить выполнение последовательности задач для клиента в Интернете**. Укажите, разрешено ли выполнение последовательности задач на интернет-клиенте. Этот параметр не поддерживает некоторые операции, которые требуют загрузки носителей, такие как установка ОС. Этот параметр следует использовать только для выполнения типовых установок ПО или последовательностей задач на основе скриптов, выполняющих операции в стандартной операционной системе.  

        - Этот параметр поддерживается для развертываний последовательности задач обновления до Windows 10 на месте в интернет-клиентах через шлюз управления облачными клиентами. Дополнительные сведения см. в разделе [Развертывание обновления до Windows 10 на месте с помощью шлюза управления облачными клиентами](#deploy-windows-10-in-place-upgrade-via-cmg).  

8. На странице **Оповещения** укажите параметры оповещений, необходимые для развертывания этой последовательности задач.  

9. На странице **Точки распространения** укажите перечисленные ниже сведения.  

    - **Параметры развертывания**. Выберите один из следующих вариантов:  

        > [!NOTE]  
        > При использовании многоадресного развертывания операционных систем содержимое можно скачивать на компьютеры по мере необходимости или перед запуском последовательности задач.  

        - **Скачивать содержимое локально, если это требуется для выполняющейся последовательности задач**. Определяет, что клиенты должны загружать содержимое из точки распространения по мере необходимости для последовательности задач. Клиент запускает последовательность задач. Когда для очередного шага в этой последовательности задач потребуется содержимое, оно загружается до выполнения шага.  

        - **Загрузить все содержимое локально перед выполнением последовательности задач**. Определяет, что клиенты должны скачивать все содержимое из точки распространения до выполнения последовательности задач. Этот параметр не отображается, если на странице **Параметры развертывания** вы указали, что последовательность задач доступна для развертываний через PXE и с загрузочных носителей.  

        - **Получать доступ к содержимому прямо в точке распространения, если это требуется для выполняющейся последовательности задач**. Укажите, что клиенты должны запускать содержимое из точки распространения. Этот параметр доступен только в случае, если для всех пакетов, связанных с этой последовательностью задач, разрешено использовать общую папку пакетов в точке распространения. Чтобы включить использование общей папки пакетов, используйте вкладку **Доступ к данным** в окне **Свойства** у каждого пакета.  

            > [!IMPORTANT]  
            > Для обеспечения наибольшей безопасности выберите вариант **Скачивать содержимое локально, если это требуется для выполняющейся последовательности задач** или **Загрузить все содержимое локально перед выполнением последовательности задач**. Если выбран любой из этих вариантов, Configuration Manager хэширует пакеты для гарантии их целостности. Если вы выберете вариант **Обращаться к содержимому непосредственно в точке распространения, если требуется для последовательности задач**, Configuration Manager не проверяет хэш пакета перед запуском указанной программы. Сайт не может гарантировать целостность пакета, и его могут изменять любые пользователи с административными правами.  

    - **Если нет доступных локальных точек распространения, использовать удаленную точку распространения**. Определяет, могут ли клиенты использовать точки распространения из соседней группы границ для скачивания содержимого, которое требуется для последовательности задач.  

    - **Разрешить клиентам использовать точки распространения из группы границ сайта по умолчанию**. Определяет, должны ли клиенты скачивать содержимое из точки распространения в группе границ сайта по умолчанию, если это содержимое недоступно в точках распространения в текущей или соседней группах границ.  

        > [!Note]  
        > С версии 1810, когда устройство выполняет последовательность задач и ему нужно получить содержимое, теперь для него доступны режимы группы границ, так же как и для клиента Configuration Manager. Дополнительные сведения см. в разделе [Поддержка последовательности задач для групп границ](../../core/servers/deploy/configure/boundary-groups.md#bkmk_bgr-osd).<!--1359025-->  

10. Чтобы сохранить эти параметры для повторного использования, на вкладке **Сводка** выберите параметр **Сохранить как шаблон**. Укажите имя шаблона и выберите параметры для сохранения.  

11. Завершите работу мастера.  

## <a name="deploy-windows-10-in-place-upgrade-via-cmg"></a>Развертывание обновления до Windows 10 на месте с помощью шлюза управления облачными клиентами

<!-- 1357149 -->
Последовательность задач обновления на месте до Windows 10 поддерживает развертывание на интернет-клиентах через [шлюз управления облачными клиентами](../../core/clients/manage/cmg/plan-cloud-management-gateway.md). Эта возможность позволяет удаленным пользователям проще обновиться до Windows 10 без необходимости подключения к интрасети.

Убедитесь, что все содержимое, на которое ссылается последовательность задач обновления на месте, распределяется в шлюз управления облачными клиентами с поддержкой содержимого. (Включите [Параметр CMG](../../core/clients/manage/cmg/setup-cloud-management-gateway.md#settings): **Разрешить шлюзу управления облачными клиентами функционировать как облачной точке распространения и предоставлять содержимое из службы хранилища Azure**.) Также можно использовать [облачную точку распространения или шлюз управления облаком](../../core/plan-design/hierarchy/use-a-cloud-based-distribution-point.md). В противном случае устройства не смогут выполнить последовательность задач.

При развертывании последовательности задач обновления используйте следующие варианты:

- **Разрешить выполнение последовательности задач для клиента в Интернете** на вкладке "Взаимодействие с пользователем" развертывания.  

- Выберите один из следующих параметров на вкладке "Точки распространения" в развертывании:

  - **Загружать содержимое локально, если это требуется для выполняющейся последовательности задач**. Начиная с версии 1910, механизм последовательности задач может скачивать пакеты по запросу из CMG с поддержкой содержимого или облачной точки распространения. Это изменение обеспечивает дополнительную гибкость при развертывании обновления Windows 10 на месте для интернет-устройств.<!--3601238-->

  - **Загружать все содержимое локально перед выполнением последовательности задач**. В Configuration Manager версии 1906 и более ранних в этом сценарии не работают другие параметры, например **Скачивать содержимое локально, если это требуется для выполняющейся последовательности задач**. Подсистема последовательности задач не может загружать содержимое из облачного источника. Клиенту Configuration Manager необходимо загрузить содержимое из облака перед запуском последовательности задач. Этот параметр можно использовать в версии 1910, если это необходимо для выполнения ваших требований.

- (*Необязательно.* ) На вкладке "Общие" развертывания выберите **Предварительно скачивать содержимое для этой последовательности задач**. Дополнительные сведения см. в разделе [Настройка предварительного кэширования содержимого](configure-precache-content.md).  

> [!NOTE]
> Запустите последовательность задач из центра программного обеспечения. Этот сценарий не поддерживает Windows PE, PXE или носитель с последовательностью задач.

## <a name="high-risk-deployments"></a><a name="bkmk_high-risk"></a> Развертывания с высоким риском

При осуществлении развертывания с высоким риском, например операционной системы, в окне **Выбор коллекции** отображаются только пользовательские коллекции, которые соответствуют параметрам проверки развертывания, настроенным в свойствах сайта. Развертывания с высоким риском всегда ограничены пользовательскими коллекциями, создаваемыми вами коллекциями и встроенной коллекцией **Неизвестные компьютеры** . При создании развертывания с высоким риском невозможно выбрать встроенную коллекцию, например **Все системы**. Чтобы просмотреть все пользовательские коллекции, в которых число клиентов меньше установленного предела, снимите флажок **Hide collections with a member count greater than the site's minimum size configuration** (Скрыть коллекции с количеством элементов, превышающим конфигурация минимального размера сайта). Дополнительные сведения см. в разделе [Параметры для управления развертываниями с высоким риском](../../core/servers/manage/settings-to-manage-high-risk-deployments.md).  

Параметры проверки развертывания основываются на текущем членстве в коллекции. После развертывания последовательности задач Configuration Manager повторно не анализирует членство в коллекции с учетом параметров развертывания высокого риска.  

Например, предположим, что для параметра **Размер по умолчанию** установлено значение 100, а для параметра **Максимальный размер** — значение 1000. При создании развертывания с высоким риском в окне **Выбор коллекции** отображаются только те коллекции, которые содержат менее 100 клиентов. Если снять флажок **Скрыть коллекции с количеством элементов, превышающим конфигурацию минимального размера сайта**, в окне отображаются коллекции, содержащие менее 1000 клиентов.  

При выборе коллекции, содержащей роль сайта, применяется следующее правило.  

- Если коллекция содержит сервер системы сайта и вы настроили параметры проверки развертывания для блокировки коллекций с серверами системы сайта, то возникает ошибка. Продолжить создание развертывания невозможно.  

- Если применимо одно из следующий условий, мастер развертывания программного обеспечения отображает предупреждение о высоком риске. Чтобы продолжить, подтвердите создание развертывания с высоким риском. После этого сайт создает сообщение о состоянии аудита.  

  - Если коллекция содержит сервер системы сайта и вы настроили параметры проверки развертывания для предупреждения о коллекциях с серверами системы сайта.  

  - Если коллекция превышает размер по умолчанию.

  - Если коллекция содержит сервер.  

## <a name="see-also"></a>См. также

[Управление последовательностями задач для их автоматизации](manage-task-sequences-to-automate-tasks.md)
