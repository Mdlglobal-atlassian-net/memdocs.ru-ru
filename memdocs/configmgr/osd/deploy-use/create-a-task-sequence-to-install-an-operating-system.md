---
title: Создание последовательности задач для установки ОС
titleSuffix: Configuration Manager
description: Используйте последовательности задач в Configuration Manager для автоматической установки образа операционной системы и другого содержимого на конечном компьютере.
ms.date: 07/26/2019
ms.prod: configuration-manager
ms.technology: configmgr-osd
ms.topic: conceptual
ms.assetid: 217c8a0e-5112-420e-a325-2a6d75326290
author: aczechowski
ms.author: aaroncz
manager: dougeby
ms.openlocfilehash: 6e1b298856edea3f81cab2e9cd5ab75af49dff51
ms.sourcegitcommit: bbf820c35414bf2cba356f30fe047c1a34c5384d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/21/2020
ms.locfileid: "81707312"
---
# <a name="create-a-task-sequence-to-install-an-os"></a>Создание последовательности задач для установки ОС

*Область применения: Configuration Manager (Current Branch)*

Используйте последовательности задач в Configuration Manager для автоматической установки образа операционной системы на конечном компьютере. Вы создаете последовательность задач, ссылающуюся на образ загрузки, который используется для запуска конечного компьютера, образ ОС, который требуется установить на конечном компьютере, а также любое дополнительное содержимое (например, другие приложения и обновления программного обеспечения), которое требуется установить. После этого последовательность задач развертывается в коллекции, содержащей конечный компьютер.  

## <a name="create-a-task-sequence-to-install-an-os"></a><a name="BKMK_InstallOS"></a> Создание последовательности задач для установки ОС

Существует множество сценариев развертывания операционной системы на компьютерах в среде. В большинстве случаев следует создать последовательность задач и выбрать вариант **Установить существующий образ** в мастере создания последовательности задач. При этом создается последовательность задач, которая устанавливает ОС, переносит параметры пользователя, применяет обновления программного обеспечения и устанавливает приложения.

### <a name="prerequisites"></a>Предварительные условия

Перед созданием последовательности задач для установки ОС должны быть выполнены следующие требования:

#### <a name="required"></a>Обязательное

- [Образ загрузки](../get-started/manage-boot-images.md).  

- [Образ ОС](../get-started/manage-operating-system-images.md)  

#### <a name="required-if-used"></a>Обязательно (если используется)

- Синхронизация [обновлений программного обеспечения](../../sum/get-started/synchronize-software-updates.md).  

- Добавление [приложений](../../apps/deploy-use/create-applications.md).  

### <a name="process-to-create-a-task-sequence-that-installs-an-os"></a>Процесс создания последовательности задач, устанавливающей ОС  

1. В консоли Configuration Manager перейдите к рабочей области **Библиотека программного обеспечения**, разверните узел **Операционные системы** и выберите **Последовательности задач**.  

2. На вкладке **Главная** на ленте в группе **Создать** выберите **Создать последовательность задач**. Это действие запускает мастер создания последовательности задач.  

3. На странице **Создание новой последовательности задач** выберите команду **Установить существующий образ** и нажмите кнопку **Далее**.  

4. На странице **Сведения о последовательности задач** настройте следующие параметры.  

    - **Имя последовательности задач**. Укажите имя последовательности задач.  

    - **Описание**. Укажите описание действий последовательности задач.  

    - **Образ загрузки**. Укажите загрузочный образ, который используется последовательностью задач для установки ОС на конечном компьютере. Загрузочный образ содержит версию Windows PE, а также все требуемые дополнительные драйверы устройств. Дополнительные сведения см. в разделе [Управление загрузочными образами](../get-started/manage-boot-images.md).  

        > [!IMPORTANT]  
        > Архитектура загрузочного образа должна быть совместимой с архитектурой оборудования конечного компьютера.  

5. На странице **Установка Windows** настройте следующие параметры:  

    - **Пакет образа**. Укажите пакет с образом устанавливаемой ОС. Дополнительные сведения см. в разделе [Управление образами операционных систем](../get-started/manage-operating-system-images.md).  

    - **Образ**. Если пакет с образом ОС содержит несколько образов, укажите индекс устанавливаемого образа.  

    - **Partition and format the target computer installing the operating system** (Создать разделы и выполнить форматирование на конечном компьютере перед установкой операционной системы). Укажите, должна ли последовательность задач создавать разделы и выполнять форматирование на конечном компьютере перед установкой операционной системы.  

    - **Ключ продукта**. При необходимости укажите ключ продукта Windows. Можно указать зашифрованные ключи многократной установки или стандартные ключи продукта. Если вы используете незашифрованный ключ продукта, каждая группа из пяти символов должна быть разделена дефисом (`-`). Пример. *XXXXX-XXXXX-XXXXX-XXXXX-XXXXX*  

    - **Режим лицензирования сервера**. Выберите режим лицензирования сервера **Для каждого рабочего места**, **Для каждого сервера** или не указывайте лицензию. В случае использования варианта **Для каждого сервера**следует также указать максимальное число подключений.  

    - Укажите способ управления учетной записью администратора для новой ОС:  

        - **Задать произвольно пароль учетной записи локального администратора и отключить учетную запись локального администратора на всех поддерживаемых платформах (рекомендуется)** . Windows отключает учетную запись локального администратора после развертывания образа ОС последовательностью задач.  

        - **Включить учетную запись локального администратора и задать пароль**. Windows использует один и тот же пароль для учетной записи локального администратора на всех компьютерах, на которых последовательность задач развертывает образ ОС.  

6. На странице **Настроить сеть** настройте следующие параметры.  

    - **Присоединить к рабочей группе**. Добавление конечного компьютера к рабочей группе.  

    - **Присоединить к домену**. Добавление конечного компьютера к домену. Укажите имя домена в разделе **Домен**.  

        > [!IMPORTANT]  
        > Чтобы указать домен из локального леса, достаточно просмотреть структуру последнего; в случае же с удаленным лесом необходимо знать (и ввести) имя домена.  

        Кроме того, можно указать подразделение в поле **Организационное подразделение (OU) домена**. Это необязательный параметр, содержащий различающееся имя подразделения в каталоге LDAP X.500. Если этого подразделения еще нет, Windows создает в нем учетную запись компьютера.  

    - **Учетная запись**. Введите имя пользователя и пароль учетной записи, у которой есть разрешения на присоединение к выбранному домену. Например: *domain\user* или *%variable%* .  

        > [!IMPORTANT]  
        > Введите надлежащие учетные данные домена, если вы планируете перенести параметры домена или рабочей группы.  

7. На странице **Установка Configuration Manager** выберите пакет клиента Configuration Manager, устанавливаемый на конечный компьютер. Кроме того, можно включить любые свойства установки.  

8. На странице **Миграция состояния** настройте следующие параметры.  

    - **Сохранить настройки пользователя**. Последовательность задач записывает состояние пользователя. Сведения о сборе и восстановлении данных о пользовательской среде см. в статье [Управление пользовательской средой](../get-started/manage-user-state.md).  

    - **Сохранить параметры сети**. Последовательность задач сохраняет параметры сети конечного компьютера. Помимо параметров сетевого адаптера, она сохраняет и членство в домене или рабочей группе.  

    - **Сохранить настройки Microsoft Windows**. Последовательность задач сохраняет параметры Windows конечного компьютера перед установкой образа ОС. Этот параметр позволяет сохранять имя компьютера, зарегистрированного пользователя или организации, а также параметры часового пояса.  

9. На странице **Включить обновления** укажите, следует ли устанавливать только обязательные обновления ПО, все обновления или не устанавливать их вообще. Если выбран вариант установки обновлений программного обеспечения, Configuration Manager устанавливает только те обновления ПО, которые относятся к коллекциям, в которые входит конечный компьютер.  

10. На странице **Установить приложения** укажите приложения, которые необходимо установить на конечный компьютер. Если задано несколько приложений, можно настроить продолжение выполнения последовательности задач в случае сбоя установки определенного приложения.  

11. Завершите работу мастера.  

Теперь можно развернуть последовательность задач для коллекции компьютеров. Дополнительные сведения см. в статье [Deploy a task sequence](deploy-a-task-sequence.md).


## <a name="pre-cache-content"></a>Предварительное кэширование содержимого

<!--4224642-->
Начиная с версии 1906 можно включить этот тип последовательности задач для предварительного кэширования содержимого. Функция предварительного кэширования для доступных развертываний последовательностей задач позволяет клиентам скачивать только необходимое содержимое, прежде чем пользователь установит последовательность задач.  

Дополнительные сведения см. в разделе [Настройка предварительного кэширования содержимого](configure-precache-content.md).


## <a name="example-task-sequence"></a><a name="BKMK_InstallExistingOSImageTSExample"></a> Пример последовательности задач

Приведенную ниже таблицу можно использовать в качестве руководства при создании последовательности задач для развертывания ОС с помощью существующего образа. Таблица поможет при выработке общей структуры шагов последовательности задач и объединении их в логические группы. Последовательность задач, созданная вами, может отличаться от представленного примера и включать в себя больше (или меньше) шагов и групп.  

> [!NOTE]  
> Для создания этой последовательности задач используйте мастер создания последовательности задач.  
>
> При использовании мастера создания последовательности задач для создания последовательности названия некоторых шагов будут отличаться от равнозначных им шагов, добавленных в существующую последовательность задач вручную.

|Шаг или группа последовательности задач|Описание:|  
|---------------------------------|-----------------|  
|Сбор файлов и параметров — **(новая группа последовательности задач)**|Создание группы последовательности задач. Группа последовательности задач используется для группирования сходных шагов в целях повышения управляемости и упрощения управления ошибками.<br /><br /> Группа содержит шаги, необходимые для записи файлов и параметров из операционной системы эталонного компьютера.|  
|Сохранить параметры Windows|Этот шаг последовательности задач служит для идентификации параметров Microsoft Windows, которые требуется записать на эталонном компьютере. Можно записать такие данные, как имя компьютера, сведения о пользователе и организации и параметры часового пояса.|  
|Сохранить параметры сети|Этот шаг последовательности задач служит для запуска параметров сети с эталонного компьютера. Можно записать данные о членстве эталонного компьютера в домене или рабочей группе и сведения о параметрах сетевого адаптера.|  
|Сбор файлов и параметров пользователя — **(новая подгруппа последовательности задач)**|Создание подгруппы последовательности задач в пределах группы последовательности задач. Эта подгруппа содержит шаги, которые необходимы для сбора данных о пользовательской среде. Так же, как и в первоначально добавленной группе, в этой подгруппе сходные шаги последовательности задач содержатся вместе, что позволяет оптимизировать их организацию и управление ошибками.|  
|Запрос хранилища состояния пользователей|Этот шаг последовательности задач используется, чтобы запросить доступ к точке миграции состояния, на которой хранятся данные пользовательской среды. Этот шаг последовательности задач можно настроить для выполнения сбора или восстановления данных пользовательской среды.|  
|Сбор файлов и параметров пользователя|Это шаг последовательности задач используется для запуска средства миграции пользовательской среды (USMT), с помощью которого выполняется сбор параметров и данных пользовательской среды на эталонном компьютере, на который будет передана последовательность задач, связанная с этим шагом. Вы можете записать стандартные параметры или указать, какие параметры необходимо записать.|  
|Выпуск: хранилище состояния пользователей|Этот шаг последовательности задач используется для уведомления точки миграции состояния о выполнении действия записи или восстановления.|  
|Установить операционную систему — **(новая группа последовательности задач)**|Создание новой подгруппы последовательности задач. Эта подгруппа содержит шаги, необходимые для установки и настройки среды предустановки Windows.|  
|Перезапустить в Windows PE|Этот шаг последовательности задач служит для задания параметров перезагрузки для конечного компьютера, получающего последовательность задач. Этот шаг выводит сообщение для пользователя, указывая, что для продолжения установки необходимо перезагрузить компьютер.<br /><br /> Этим шагом используется переменная последовательности задач **_SMSTSInWinPE** , доступная только для чтения. Если связанное значение — **false** , выполнение последовательности задач будет продолжено.|  
|Создать разделы на диске 0|Этот шаг последовательности задач указывает действия, необходимые для форматирования жесткого диска на конечном компьютере. По умолчанию обрабатывается диск номер **0**.<br /><br /> Этим шагом используется переменная последовательности задач **_SMSTSClientCache** , доступная только для чтения. Этот шаг выполняется, если кэш клиентов Configuration Manager не существует.|  
|Применить операционную систему|Этот шаг последовательности задач используется для установки образа операционной системы на конечный компьютер. Сначала этот шаг удаляет все файлы на этом томе, за исключением файлов элементов управления, относящихся к Configuration Manager. Затем он применяет все образы томов, которые содержатся в WIM-файле, к соответствующему последовательному тому диска на конечном компьютере. Чтобы задать, какой раздел диска будет использоваться для установки, можно также указать файл ответов **sysprep** .|  
|Применить настройки Windows|Этот шаг последовательности задач используется для настройки параметров Windows на конечном компьютере. К таким параметрам Windows относятся сведения о пользователе и организации, сведения о ключе продукта или лицензионном ключе, параметры часового пояса и пароль локального администратора.|  
|Применить параметры сети|Этот шаг последовательности задач используется для задания параметров сети или рабочей группы на конечном компьютере. Также можно указать, использует ли компьютер DHCP-сервер, или задать параметры назначенного статического IP-адреса.|  
|Применить драйверы устройств|Этот шаг последовательности задач служит для установки драйверов в составе развертывания операционной системы. Программе установки Windows можно разрешить искать драйверы во всех существующих категориях, выбрав параметр **Использовать драйверы всех категорий** , или ограничить круг доступных категорий, выбрав **Использовать драйверы только из указанных категорий**.<br /><br /> Этим шагом используется переменная последовательности задач **_SMSTSMediaType** , доступная только для чтения. Этот шаг последовательности задач выполняется, только если значение переменной не равняется **FullMedia**.|  
|Применить пакет драйверов|Этот шаг последовательности задач используется, чтобы предоставить программе установки Windows доступ ко всем драйверам в пакете драйверов.|  
|Настроить операционную систему — **(новая группа последовательности задач)**|Создание новой подгруппы последовательности задач. Эта подгруппа содержит шаги, которые необходимы для настройки установленной операционной системы.|  
|Настройка Windows и Configuration Manager|Используйте этот шаг последовательности задач для установки клиентского программного обеспечения Configuration Manager. Configuration Manager устанавливает и регистрирует GUID клиента Configuration Manager. Необходимые параметры установки можно назначить в окне **Свойства установки** .|  
|Установить обновления|Этот шаг используется для указания способа установки обновлений программного обеспечения на конечный компьютер. На конечном компьютере не проверяется на наличие применимых обновлений программного обеспечения, пока не будет запущен этот шаг последовательности задач. На этом шаге конечный компьютер оценивается на применимость обновлений ПО, как и любой другой клиент, управляемый Configuration Manager.<br /><br /> Этим шагом используется переменная последовательности задач **_SMSTSMediaType** , доступная только для чтения. Этот шаг последовательности задач выполняется, только если значение переменной не равняется **FullMedia**.|  
|Восстановить файлы и параметры пользователя — **(новая подгруппа последовательности задач)**|Создание новой подгруппы последовательности задач. Эта подгруппа содержит шаги, которые необходимы для восстановления файлов и параметров пользователя.|  
|Запрос хранилища состояния пользователей|Этот шаг последовательности задач используется, чтобы запросить доступ к точке миграции состояния, на которой хранятся данные пользовательской среды.|  
|Восстановить файлы и параметры пользователя|Этот шаг последовательности задач служит для запуска средства миграции пользовательской среды для восстановления параметров и пользовательской среды на конечном компьютере.|  
|Выпуск: хранилище состояния пользователей|Этот шаг последовательности задач служит для уведомления точки миграции состояния о том, что данные пользовательской среды больше не требуются.|  
