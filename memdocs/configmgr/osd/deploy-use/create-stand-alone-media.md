---
title: Создание автономного носителя
titleSuffix: Configuration Manager
description: Автономный носитель служит для развертывания операционной системы на компьютере без сетевого подключения.
ms.date: 05/02/2019
ms.prod: configuration-manager
ms.technology: configmgr-osd
ms.topic: conceptual
ms.assetid: c6b9ccd2-78d9-4f0e-b25a-70d0866300ba
author: aczechowski
ms.author: aaroncz
manager: dougeby
ms.openlocfilehash: 0e477d08ed97fe46bbe51b62a0ed024d437c2626
ms.sourcegitcommit: bbf820c35414bf2cba356f30fe047c1a34c5384d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/21/2020
ms.locfileid: "81690572"
---
# <a name="create-stand-alone-media"></a>Создание автономного носителя

*Область применения: Configuration Manager (Current Branch)*

Автономный носитель в Configuration Manager содержит все необходимое для развертывания операционной системы на компьютере без сетевого подключения.

Используйте автономный носитель в следующих сценариях развертывания операционной системы.  

- [Обновление существующего компьютера до новой версии Windows](refresh-an-existing-computer-with-a-new-version-of-windows.md)  

- [Установка новой версии Windows на новом компьютере (без операционной системы)](install-new-windows-version-new-computer-bare-metal.md)  

- [Обновление Windows до последней версии](upgrade-windows-to-the-latest-version.md)  


## <a name="usage"></a>Использование

Автономный носитель предоставляет последовательность задач, которая автоматизирует действия по установке операционной системы и другого необходимого содержимого. В состав этого содержимого входит загрузочный образ, образ операционной системы и драйверы устройств. Так как автономный носитель хранит все содержимое для развертывания операционной системы, ему требуется больше места на диске, чем носителям других типов.

При создании автономного носителя на сайте центра администрирования клиент получает из Active Directory назначенный ему код сайта. Автономный носитель, созданный на подчиненном сайте, автоматически назначает клиенту код этого сайта.  


## <a name="prerequisites"></a>Предварительные условия

Перед созданием автономного носителя с помощью мастера создания носителя последовательности задач убедитесь, что выполняются следующие условия.

### <a name="create-a-task-sequence-to-deploy-an-os"></a>Создание последовательности задач для развертывания ОС

Укажите для автономного носителя последовательность задач, которая развертывает операционную систему. Дополнительные сведения см. в статье [о создании последовательности задач для установки операционной системы](create-a-task-sequence-to-install-an-operating-system.md).

#### <a name="unsupported-actions-for-stand-alone-media"></a>Неподдерживаемые действия для автономных носителей

Автономный носитель не поддерживает следующие действия:

- шаг [Автоматическое применение драйверов](../understand/task-sequence-steps.md#BKMK_AutoApplyDrivers) в последовательности задач. Автономный носитель не поддерживает автоматическое применение драйверов устройств из каталога драйверов. Используйте шаг [Применить пакет драйверов](../understand/task-sequence-steps.md#BKMK_ApplyDriverPackage), чтобы программа установки Windows могла получить доступ к указанному набору драйверов;  

- шаг [Скачать содержимое пакета](../understand/task-sequence-steps.md#BKMK_DownloadPackageContent) в последовательности задач. Сведения о точке управления недоступны на автономном носителе, поэтому при попытке перечислить расположения содержимого шаг завершится сбоем;  

- установку обновлений программного обеспечения;  

- установка программного обеспечения до развертывания операционной системы;  

- пользовательские последовательности задач для развертываний, не включающих ОС;  

- связывание пользователей с конечным компьютером (поддержка сопоставления пользователей и устройств).  

- динамическая установка пакетов посредством шага [Установить пакеты](../understand/task-sequence-steps.md#BKMK_InstallPackage);  

- динамическая установка приложений посредством шага [Установка приложения](../understand/task-sequence-steps.md#BKMK_InstallApplication);

- параметр **Использовать предварительную версию пакета клиента, если она доступна** для шага последовательности задач **Настройка Windows и Configuration Manager**. Дополнительные сведения об этом параметре см.в статье [Настройка Windows и Configuration Manager](../understand/task-sequence-steps.md#BKMK_SetupWindowsandConfigMgr).  

> [!NOTE]  
> Если последовательность задач включает шаг [Установить пакет](../understand/task-sequence-steps.md#BKMK_InstallPackage) и вы создаете автономный носитель на сайте центра администрирования, может возникнуть ошибка. У сайта центра администрирования нет необходимых политик конфигурации клиентов. Эти политики необходимы для включения агента распространения программного обеспечения во время выполнения последовательности задач. В файле журнала **CreateTsMedia.log** может фиксироваться следующая ошибка:  
>
> `WMI method SMS_TaskSequencePackage.GetClientConfigPolicies failed (0x80041001)`
>
> Для автономного носителя, включающего шаг **Установить пакет**, создайте автономный носитель на первичном сайте с включенным агентом распространения ПО.
>
> В качестве альтернативы используйте пользовательский шаг [Выполнить из командной строки](../understand/task-sequence-steps.md#BKMK_RunCommandLine). Добавьте его после шага [Настройка Windows и Configuration Manager](../understand/task-sequence-steps.md#BKMK_SetupWindowsandConfigMgr) и перед первым шагом **Установить пакет**. Шаг **Выполнить из командной строки** выполняет следующую команду WMIC, чтобы включить агент распространения ПО до первого шага "Установить пакет".  
>
> `WMIC /namespace:\\\root\ccm\policy\machine\requestedconfig path ccm_SoftwareDistributionClientConfig CREATE ComponentName="Enable SWDist", Enabled="true", LockSettings="TRUE", PolicySource="local", PolicyVersion="1.0", SiteSettingsKey="1" /NOINTERACTIVE`

### <a name="distribute-all-content-associated-with-the-task-sequence"></a>Распространение всего содержимого, связанного с последовательностью задач

Разместите все содержимое, необходимое для последовательности задач, хотя бы в одной точке распространения. Сюда входят загрузочный образ, образ ОС и другие связанные с ними файлы. При создании носителя мастер получает это содержимое из точки распространения.

Используемая учетная запись пользователя должна обладать по меньшей мере правами на **чтение** из библиотеки содержимого в точке распространения. Дополнительные сведения см. в разделе [Распространение содержимого](../../core/servers/deploy/configure/deploy-and-manage-content.md#bkmk_distribute).

### <a name="prepare-the-removable-usb-drive"></a>Подготовка съемного USB-накопителя

Если вы используете съемный USB-накопитель, подключите его к компьютеру, на котором запускается мастер создания носителя с файлом последовательности задач. USB-накопитель должен определяться операционной системой Windows как съемное устройство. При создании носителя мастер осуществляет запись непосредственно на USB-накопитель.

Автономный носитель использует файловую систему FAT32. Невозможно создать на съемном USB-накопителе автономный носитель с файлом размером более 4 ГБ.

### <a name="create-an-output-folder"></a>Создание папки для выходных данных

Прежде чем запускать мастер создания носителя с файлом последовательности задач для создания компакт- или DVD-диска, создайте папку для создаваемых мастером файлов. Данные для компакт- или DVD-диска сохраняются в эту папку в формате ISO-файлов.


## <a name="process"></a>Процесс

1. В консоли Configuration Manager перейдите к рабочей области **Библиотека программного обеспечения**, разверните узел **Операционные системы** и выберите **Последовательности задач**.  

2. На вкладке **Главная** в ленте в группе **Создать** выберите **Создать носитель с файлом последовательности задач**. Это действие запускает мастер создания носителя с последовательностью задач.  

3. На странице **Выбор типа носителя** настройте следующие параметры:  

    - Выберите **Автономный носитель**.  

    - Если вам нужно лишь разрешить развертывание операционной системы без взаимодействия с пользователем, установите флажок **Разрешить автоматическое развертывание операционной системы**.  

        > [!IMPORTANT]  
        > Если этот флажок установлен, пользователю не будет предложено ввести сведения о конфигурации сети или выбрать последовательность задач. Если для носителя настроена защита паролем, пользователю может потребоваться ввести пароль.  

4. На странице **Тип носителя** укажите, является ли носитель **съемным USB-накопителем** или **набором CD или DVD-дисков**. Настройте следующие параметры:  

    > [!IMPORTANT]  
    > Носитель использует файловую систему FAT32. Вы не сможете создать носитель на USB-устройстве с файлами размером более 4 ГБ.  

    - Если выбран вариант **Съемный USB-накопитель**, выберите диск, на котором должно быть сохранено содержимое.  

        - **Форматировать съемный USB-накопитель (FAT32) и сделать его загрузочным**: по умолчанию подготовку USB-накопителя выполняет Configuration Manager. Для работы многих новых устройств UEFI требуется загрузочный раздел FAT32. Но этот формат также ограничивает размер файлов и общую емкость диска. Если вы уже отформатировали и настроили съемный накопитель, отключите этот параметр.

    - Если вы выбрали вариант **CD или DVD диск**, укажите емкость (**размер**) этого носителя, имя и путь к **файлу** для выходных данных. Мастер запишет выходные файлы в это расположение. Пример: `\\servername\folder\outputfile.iso`  

        Если емкости носителя не хватает для хранения всего содержимого, мастер создает несколько файлов. Такое содержимое придется сохранять на нескольких компакт- или DVD-дисках. Если создается несколько файлов, Configuration Manager добавляет порядковый номер к имени каждого создаваемого файла.  

        Если вы развертываете приложение вместе с операционной системой, а приложение не может поместиться на один носитель, Configuration Manager сохраняет приложение на нескольких носителях. При запуске автономного носителя Configuration Manager запрашивает у пользователя следующий носитель, на котором хранится приложение.  

        > [!IMPORTANT]  
        > При выборе существующего ISO-образа мастер создания носителя с последовательностью задач удаляет этот образ с диска или из общей папки при переходе к следующей странице мастера. Существующий образ будет удален даже при отмене работы мастера.  

    - **Промежуточная папка**.<!--1359388-->: Процесс создания носителя может потребовать много места на временном диске. По умолчанию это расположение аналогично следующему пути: `%UserProfile%\AppData\Local\Temp`. Начиная с версии 1902, вы получаете возможность гибко менять место для хранения этих временных файлов, указывая в этом параметре другой диск и путь.  

    - **Метка носителя**.<!--1359388-->: Начиная с версии 1902, вы можете добавить метку для носителя с последовательностью задач. Она помогает лучше определять носитель после его создания. Значение по умолчанию — `Configuration Manager`. Это текстовое поле отображается в следующих местах:  

        - Если подключить файл ISO, Windows отображает эту метку как имя подключенного диска.  

        - Если отформатировать USB-накопитель, первые 11 символов метки используются как имя.  

        - Configuration Manager записывает текстовый файл с именем `MediaLabel.txt` в корень носителя. По умолчанию файл содержит одну строку текста: `label=Configuration Manager`. В случае если вы настроили свою метку для носителя, эта строка использует пользовательские метки вместо значения по умолчанию.  

    - **Добавить файл autorun.inf на носитель**.<!-- 4090666 -->: Начиная с версии 1906 Configuration Manager по умолчанию не добавляет файл autorun.inf. Этот файл обычно блокируется продуктами для защиты от вредоносных программ. Дополнительные сведения об автозапуске в Windows см. в статье [Создание приложения с поддержкой автозапуска с компакт-диска](https://docs.microsoft.com/windows/desktop/shell/autoplay). Если для вашего сценария этот файл нужен, установите этот параметр, чтобы добавить файл.  

5. На странице **Безопасность** укажите следующие параметры:

    - **Защитить носитель паролем**. Введите надежный пароль, который поможет защитить носитель от несанкционированного доступа. Если пароль задан, пользователь должен будет ввести его, чтобы воспользоваться носителем.  

        > [!IMPORTANT]  
        > Для обеспечения безопасности рекомендуется всегда назначать пароль для защиты носителя.  
        >
        > На автономном носителе он шифрует только шаги последовательности задач и их переменные. Остальное содержимое носителя не шифруется. Не включайте конфиденциальную информацию в скрипты последовательности задач. Используйте переменные последовательности задач для хранения и применения важной информации.  

    - **Выберите диапазон времени действия для этого автономного носителя**. Укажите начало и окончание периода, в течение которого носитель будет считаться действительным. Это необязательный параметр. По умолчанию этот параметр отключен. Перед запуском автономного носителя даты сравниваются с системным временем. Если значение системного времени находится вне диапазона времени действия носителя, автономный носитель не запускается. Эти параметры также доступны при использовании командлета PowerShell [New-CMStandaloneMedia](https://docs.microsoft.com/powershell/module/configurationmanager/new-cmstandalonemedia?view=sccm-ps).  

6. На странице **Автономный компакт-диск или DVD-диск** выберите последовательность задач, которая развертывает ОС. Вы можете выбрать здесь только те последовательности задач, которые связаны с загрузочным образом. Проверьте список содержимого, на которое есть ссылки в последовательности задач.  

    - **Обнаружить зависимости приложения и добавить их на этот носитель**: добавьте содержимое на носитель для зависимостей приложений.  

        > [!TIP]  
        > Если здесь не отображаются зависимости приложения, которые вы ожидаете увидеть, отмените выбор и повторно выберите этот параметр для обновления списка.  

7. На странице **выбора приложения** укажите дополнительное содержимое приложения, которое нужно включить в файл носителя.  

8. На странице **выбора пакета** укажите дополнительное содержимое пакета, которое нужно включить в файл носителя.  

9. На странице **выбора пакета драйверов** укажите дополнительное содержимое пакета драйверов, которое нужно включить в файл носителя.  

10. На странице **точек распространения** укажите точки распространения, в которых находится необходимое содержимое.  

    Configuration Manager отображает только те точки распространения, в которых есть содержимое. Прежде чем продолжить, все содержимое, связанное с последовательностью задач, необходимо распространить по меньшей мере в одну точку распространения. После распространения содержимого обновите список точек распространения. Удалите все точки распространения, уже выбранные на этой странице, вернитесь на предыдущую страницу, а затем — на страницу **Точки распространения**. Вы можете также перезапустить мастер. Дополнительные сведения см. в статьях [Распространение содержимого, на которое ссылается последовательность задач](manage-task-sequences-to-automate-tasks.md#BKMK_DistributeTS) и [Управление содержимым и инфраструктурой содержимого](../../core/servers/deploy/configure/manage-content-and-content-infrastructure.md).  

11. На странице **Настройка** укажите следующие параметры:  

    - Добавьте все переменные, которые используются последовательностью задач.  

    - **Включить команду, выполняемую перед запуском**. Укажите выполняемые перед запуском команды, которые будут выполняться перед запуском последовательности задач. Команды перед запуском — это скрипты или исполняемые файлы, которые могут взаимодействовать с пользователем в среде предустановки Windows перед запуском последовательности задач. Дополнительные сведения см. в статье [Предварительные команды для носителя с последовательностью задач](../understand/prestart-commands-for-task-sequence-media.md).  

        > [!TIP]  
        > Во время создания носителя последовательность задач записывает идентификатор пакета и командную строку, выполняемую перед запуском, включая значения всех переменных последовательности задач, в файл журнала **CreateTSMedia.log** на том компьютере, где запущена консоль Configuration Manager. В этом файле журнала можно проверить значения переменных последовательности задач.  

        Если для выполнения команды перед запуском требуется содержимое, установите флажок **Добавить файлы для выполнения команды перед запуском**.  

12. Завершите работу мастера.  

В папке назначения будут созданы файлы автономного носителя (ISO-файлы). Если вы выбрали **CD или DVD диск**, вы можете записать выходные файлы на несколько компакт-дисков или DVD-дисков.


## <a name="next-steps"></a>Дальнейшие шаги

[Использование автономного носителя для развертывания Windows без применения сети](use-stand-alone-media-to-deploy-windows-without-using-the-network.md)
